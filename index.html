<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Guara Estoque - A melhor opção de Guarapari</title>
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&family=Open+Sans&display=swap" rel="stylesheet">
    <style>
        :root {
            /* Cores padrão - Vermelho Ave Guara */
            --primary: #CC0000;
            --secondary: #FFFFFF;
            --accent: #990000;
            --light: #F5F5F5;
            --dark: #333333;
            --success: #27ae60;
            --warning: #f39c12;
            --text: #333333;
            --text-light: #666666;
            --shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            --transition: all 0.3s ease;
            --whatsapp-green: #25D366;
            --facebook-blue: #1877F2;
            --instagram-purple: #E4405F;
            
            /* Novas variáveis para temas */
            --bg-color: #f9f9f9;
            --card-bg: #FFFFFF;
            --header-bg: var(--primary);
            --footer-bg: var(--primary);
            --modal-bg: #FFFFFF;
            --sidebar-bg: var(--primary);
            --input-bg: #FFFFFF;
            --border-color: #eee;
        }
        
        /* Tema Claro */
        .theme-light {
            --bg-color: #f9f9f9;
            --card-bg: #FFFFFF;
            --header-bg: var(--primary);
            --footer-bg: var(--primary);
            --modal-bg: #FFFFFF;
            --sidebar-bg: var(--primary);
            --input-bg: #FFFFFF;
            --border-color: #eee;
            --text: #333333;
            --text-light: #666666;
        }
        
        /* Tema Escuro */
        .theme-dark {
            --bg-color: #121212;
            --card-bg: #1e1e1e;
            --header-bg: #1a1a1a;
            --footer-bg: #1a1a1a;
            --modal-bg: #2d2d2d;
            --sidebar-bg: #1a1a1a;
            --input-bg: #2d2d2d;
            --border-color: #444;
            --text: #ffffff;
            --text-light: #cccccc;
            --light: #2d2d2d;
            --dark: #f5f5f5;
            --shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
        }
        
        /* Tema Azul */
        .theme-blue {
            --primary: #0066CC;
            --accent: #004C99;
            --header-bg: #0066CC;
            --footer-bg: #0066CC;
            --sidebar-bg: #0066CC;
        }
        
        /* Tema Verde */
        .theme-green {
            --primary: #009900;
            --accent: #007700;
            --header-bg: #009900;
            --footer-bg: #009900;
            --sidebar-bg: #009900;
        }
        
        /* Tema Roxo */
        .theme-purple {
            --primary: #663399;
            --accent: #552288;
            --header-bg: #663399;
            --footer-bg: #663399;
            --sidebar-bg: #663399;
        }
        
        /* Tema Laranja */
        .theme-orange {
            --primary: #FF6600;
            --accent: #CC5500;
            --header-bg: #FF6600;
            --footer-bg: #FF6600;
            --sidebar-bg: #FF6600;
        }
        
        /* Tema Rosa */
        .theme-pink {
            --primary: #E91E63;
            --accent: #C2185B;
            --header-bg: #E91E63;
            --footer-bg: #E91E63;
            --sidebar-bg: #E91E63;
        }
        
        /* Tema Cinza */
        .theme-gray {
            --primary: #607D8B;
            --accent: #455A64;
            --header-bg: #607D8B;
            --footer-bg: #607D8B;
            --sidebar-bg: #607D8B;
        }
        
        /* Novos temas adicionados */
        .theme-teal {
            --primary: #008080;
            --accent: #006666;
            --header-bg: #008080;
            --footer-bg: #008080;
            --sidebar-bg: #008080;
        }
        
        .theme-indigo {
            --primary: #4B0082;
            --accent: #3A0066;
            --header-bg: #4B0082;
            --footer-bg: #4B0082;
            --sidebar-bg: #4B0082;
        }
        
        .theme-yellow {
            --primary: #FFD700;
            --accent: #CCAD00;
            --header-bg: #FFD700;
            --footer-bg: #FFD700;
            --sidebar-bg: #FFD700;
        }
        
        .theme-brown {
            --primary: #8B4513;
            --accent: #6B3610;
            --header-bg: #8B4513;
            --footer-bg: #8B4513;
            --sidebar-bg: #8B4513;
        }
        
        .theme-cyan {
            --primary: #00BCD4;
            --accent: #0097A7;
            --header-bg: #00BCD4;
            --footer-bg: #00BCD4;
            --sidebar-bg: #00BCD4;
        }
        
        .theme-lime {
            --primary: #CDDC39;
            --accent: #AFB42B;
            --header-bg: #CDDC39;
            --footer-bg: #CDDC39;
            --sidebar-bg: #CDDC39;
        }
        
        .theme-deep-orange {
            --primary: #FF5722;
            --accent: #E64A19;
            --header-bg: #FF5722;
            --footer-bg: #FF5722;
            --sidebar-bg: #FF5722;
        }
        
        .theme-deep-purple {
            --primary: #673AB7;
            --accent: #512DA8;
            --header-bg: #673AB7;
            --footer-bg: #673AB7;
            --sidebar-bg: #673AB7;
        }
        
        .theme-light-blue {
            --primary: #03A9F4;
            --accent: #0288D1;
            --header-bg: #03A9F4;
            --footer-bg: #03A9F4;
            --sidebar-bg: #03A9F4;
        }
        
        .theme-light-green {
            --primary: #8BC34A;
            --accent: #689F38;
            --header-bg: #8BC34A;
            --footer-bg: #8BC34A;
            --sidebar-bg: #8BC34A;
        }
        
        .theme-amber {
            --primary: #FFC107;
            --accent: #FFA000;
            --header-bg: #FFC107;
            --footer-bg: #FFC107;
            --sidebar-bg: #FFC107;
        }
        
        /* Tema moderno gradient */
        .theme-gradient {
            --primary: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --accent: #5a67d8;
            --header-bg: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --footer-bg: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --sidebar-bg: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        /* Tema minimalista */
        .theme-minimal {
            --primary: #2C3E50;
            --accent: #1A252F;
            --header-bg: #2C3E50;
            --footer-bg: #2C3E50;
            --sidebar-bg: #2C3E50;
            --bg-color: #FFFFFF;
            --card-bg: #FFFFFF;
            --border-color: #E0E0E0;
            --shadow: 0 2px 4px rgba(0,0,0,0.05);
        }
        
        /* Tema neon */
        .theme-neon {
            --primary: #00FF9D;
            --accent: #00CC7A;
            --header-bg: #0A0A0A;
            --footer-bg: #0A0A0A;
            --sidebar-bg: #0A0A0A;
            --bg-color: #0A0A0A;
            --card-bg: #1A1A1A;
            --border-color: #333;
            --text: #FFFFFF;
            --text-light: #AAAAAA;
            --shadow: 0 4px 20px rgba(0, 255, 157, 0.3);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Open Sans', sans-serif;
            color: var(--text);
            background-color: var(--bg-color);
            line-height: 1.6;
            transition: var(--transition);
        }
        
        h1, h2, h3, h4, h5, h6 {
            font-family: 'Montserrat', sans-serif;
            font-weight: 600;
            margin-bottom: 1rem;
        }
        
        .container {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 15px;
        }
        
        /* Header */
        header {
            background: var(--header-bg);
            color: white;
            padding: 1rem 0;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: var(--shadow);
            transition: var(--transition);
        }
        
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .logo {
            font-family: 'Montserrat', sans-serif;
            font-size: 1.8rem;
            font-weight: 700;
            display: flex;
            align-items: center;
        }
        
        .logo i {
            color: var(--secondary);
            margin-right: 0.5rem;
        }
        
        /* Search Bar */
        .search-container {
            display: flex;
            max-width: 400px;
            width: 100%;
        }
        
        .search-input {
            flex: 1;
            padding: 10px 15px;
            border: none;
            border-radius: 4px 0 0 4px;
            font-size: 16px;
            background-color: var(--input-bg);
            color: var(--text);
            transition: var(--transition);
        }
        
        .search-button {
            background-color: var(--accent);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 0 4px 4px 0;
            cursor: pointer;
            transition: var(--transition);
        }
        
        .search-button:hover {
            background-color: var(--primary);
            filter: brightness(0.9);
        }
        
        /* Hero Section */
        .hero {
            background: linear-gradient(rgba(0, 0, 0, 0.7), rgba(0, 0, 0, 0.7)), url('https://images.unsplash.com/photo-1556742049-0cfed4f6a45d?ixlib=rb-4.0.3&auto=format&fit=crop&w=1600&q=80');
            background-size: cover;
            background-position: center;
            color: white;
            text-align: center;
            padding: 5rem 1rem;
            margin-bottom: 2rem;
        }
        
        .hero h1 {
            font-size: 2.5rem;
            margin-bottom: 1rem;
        }
        
        .hero p {
            font-size: 1.2rem;
            max-width: 700px;
            margin: 0 auto 2rem;
        }
        
        /* Products Grid */
        .products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 1.5rem;
            margin: 2rem 0;
        }
        
        @media (max-width: 768px) {
            .products-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 1rem;
            }
            
            .search-container {
                max-width: 250px;
            }
            
            .header-content {
                flex-direction: column;
                gap: 15px;
            }
            
            .search-container {
                max-width: 100%;
                order: 3;
            }
        }
        
        @media (max-width: 480px) {
            .products-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 0.75rem;
            }
        }
        
        .product-card {
            background-color: var(--card-bg);
            border-radius: 8px;
            overflow: hidden;
            box-shadow: var(--shadow);
            transition: var(--transition);
            position: relative;
            display: flex;
            flex-direction: column;
            cursor: pointer;
            height: 100%;
            border: 1px solid var(--border-color);
        }
        
        .product-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.15);
        }
        
        .product-image {
            height: 180px;
            overflow: hidden;
            position: relative;
            background-color: var(--light);
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .product-image img {
            width: 100%;
            height: 100%;
            object-fit: contain;
            padding: 10px;
            transition: var(--transition);
        }
        
        .product-card:hover .product-image img {
            transform: scale(1.03);
        }
        
        /* Badge de desconto */
        .discount-badge {
            position: absolute;
            top: 10px;
            left: 10px;
            background-color: var(--success);
            color: white;
            padding: 5px 10px;
            border-radius: 4px;
            font-weight: bold;
            font-size: 0.8rem;
            z-index: 2;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        
        .product-details {
            padding: 1rem;
            flex-grow: 1;
            display: flex;
            flex-direction: column;
        }
        
        .product-title {
            font-size: 1rem;
            margin-bottom: 0.5rem;
            color: var(--text);
            line-height: 1.3;
            height: 2.6em;
            overflow: hidden;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
        }
        
        .product-price {
            color: var(--text);
            font-size: 1.3rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }
        
        .product-old-price {
            color: var(--primary);
            text-decoration: line-through;
            font-size: 0.9rem;
            margin-right: 0.5rem;
        }
        
        .product-description {
            color: var(--text-light);
            margin-bottom: 0.75rem;
            flex-grow: 1;
            font-size: 0.85rem;
            line-height: 1.4;
            height: 2.8em;
            overflow: hidden;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
        }
        
        .product-features {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 0.75rem;
            border-top: 1px solid var(--border-color);
            padding-top: 0.75rem;
        }
        
        .product-feature {
            display: flex;
            align-items: center;
            font-size: 0.8rem;
            white-space: nowrap;
        }
        
        .product-feature i {
            margin-right: 0.3rem;
            color: var(--accent);
        }
        
        .product-status {
            display: inline-block;
            padding: 0.2rem 0.6rem;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: 600;
            margin-bottom: 0.75rem;
            align-self: flex-start;
        }
        
        .in-stock {
            background-color: rgba(39, 174, 96, 0.2);
            color: #27ae60;
        }
        
        .low-stock {
            background-color: rgba(243, 156, 18, 0.2);
            color: #f39c12;
        }
        
        .out-of-stock {
            background-color: rgba(204, 0, 0, 0.2);
            color: #cc0000;
        }
        
        /* Botão VER PRODUTO */
        .view-product-btn {
            background-color: var(--success);
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 4px;
            cursor: pointer;
            margin-top: 5px;
            width: 100%;
            transition: var(--transition);
            font-weight: 600;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .view-product-btn:hover {
            background-color: #219653;
            transform: translateY(-2px);
        }
        
        .contact-seller-btn {
            background-color: var(--whatsapp-green);
            color: white;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% {
                box-shadow: 0 0 0 0 rgba(37, 211, 102, 0.4);
            }
            70% {
                box-shadow: 0 0 0 10px rgba(37, 211, 102, 0);
            }
            100% {
                box-shadow: 0 0 0 0 rgba(37, 211, 102, 0);
            }
        }
        
        .contact-seller-btn:hover {
            background-color: #1da851;
            animation: none;
        }
        
        /* Modal de Produto Expandido */
        .product-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            padding: 20px;
            overflow-y: auto;
        }
        
        .product-modal-content {
            background-color: var(--modal-bg);
            border-radius: 8px;
            width: 100%;
            max-width: 900px;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
            transition: var(--transition);
        }
        
        .product-modal-close {
            position: absolute;
            top: 15px;
            right: 15px;
            background: rgba(204, 0, 0, 0.8);
            color: white;
            border: none;
            border-radius: 50%;
            width: 36px;
            height: 36px;
            font-size: 1.2rem;
            cursor: pointer;
            z-index: 10;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
        }
        
        .product-modal-close:hover {
            background: rgba(204, 0, 0, 1);
        }
        
        .product-modal-body {
            display: flex;
            flex-direction: column;
        }
        
        @media (min-width: 768px) {
            .product-modal-body {
                flex-direction: row;
            }
        }
        
        .product-modal-images {
            flex: 1;
            min-height: 300px;
            background-color: var(--light);
            display: flex;
            flex-direction: column;
            position: relative;
        }
        
        .product-modal-main-image {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        
        .product-modal-main-image img {
            max-width: 100%;
            max-height: 300px;
            object-fit: contain;
        }
        
        .product-modal-thumbnails {
            display: flex;
            gap: 10px;
            padding: 15px;
            overflow-x: auto;
            border-top: 1px solid var(--border-color);
        }
        
        .product-modal-thumbnail {
            width: 60px;
            height: 60px;
            border-radius: 4px;
            overflow: hidden;
            cursor: pointer;
            border: 2px solid transparent;
            transition: var(--transition);
            flex-shrink: 0;
        }
        
        .product-modal-thumbnail.active {
            border-color: var(--primary);
        }
        
        .product-modal-thumbnail img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .product-modal-info {
            flex: 1;
            padding: 2rem;
        }
        
        @media (max-width: 767px) {
            .product-modal-info {
                padding: 1.5rem;
            }
        }
        
        .product-modal-title {
            font-size: 1.8rem;
            margin-bottom: 1rem;
            color: var(--text);
        }
        
        .product-modal-price {
            color: var(--text);
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 1rem;
        }
        
        .product-modal-old-price {
            color: var(--primary);
            text-decoration: line-through;
            font-size: 1.2rem;
            margin-right: 0.5rem;
        }
        
        /* Badge de desconto no modal */
        .discount-percentage {
            display: inline-block;
            background-color: var(--success);
            color: white;
            padding: 0.3rem 0.6rem;
            border-radius: 4px;
            font-size: 0.9rem;
            font-weight: bold;
            margin-left: 0.5rem;
        }
        
        .product-modal-description {
            color: var(--text);
            margin-bottom: 1.5rem;
            line-height: 1.6;
            font-size: 1rem;
        }
        
        .product-modal-features {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-bottom: 1.5rem;
            padding: 1rem 0;
            border-top: 1px solid var(--border-color);
            border-bottom: 1px solid var(--border-color);
        }
        
        .product-modal-feature {
            display: flex;
            align-items: center;
            font-size: 0.95rem;
        }
        
        .product-modal-feature i {
            margin-right: 0.5rem;
            color: var(--primary);
        }
        
        .product-modal-stock {
            display: inline-block;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            font-size: 0.9rem;
            font-weight: 600;
            margin-bottom: 1.5rem;
        }
        
        .product-modal-actions {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 1rem;
        }
        
        .product-modal-action-btn {
            flex: 1;
            min-width: 200px;
            padding: 12px 20px;
            border-radius: 4px;
            border: none;
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .product-modal-view-images {
            background-color: var(--accent);
            color: white;
        }
        
        .product-modal-contact {
            background-color: var(--whatsapp-green);
            color: white;
            animation: pulse 2s infinite;
        }
        
        .product-modal-edit {
            background-color: var(--warning);
            color: white;
        }
        
        .product-modal-delete {
            background-color: var(--accent);
            color: white;
        }
        
        .product-modal-update-stock {
            background-color: var(--success);
            color: white;
        }
        
        .product-modal-view-images:hover {
            background-color: var(--primary);
            filter: brightness(0.9);
        }
        
        .product-modal-contact:hover {
            background-color: #1da851;
            animation: none;
        }
        
        .product-modal-edit:hover {
            background-color: #e67e22;
        }
        
        .product-modal-delete:hover {
            background-color: var(--primary);
            filter: brightness(0.9);
        }
        
        .product-modal-update-stock:hover {
            background-color: #219653;
        }
        
        /* Botões de compartilhamento */
        .share-buttons {
            display: flex;
            gap: 10px;
            margin-top: 1rem;
            flex-wrap: wrap;
        }
        
        .share-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 10px 15px;
            border-radius: 4px;
            color: white;
            text-decoration: none;
            font-weight: 600;
            transition: var(--transition);
            flex: 1;
            min-width: 120px;
        }
        
        .share-btn i {
            margin-right: 8px;
        }
        
        .whatsapp-share {
            background-color: var(--whatsapp-green);
        }
        
        .facebook-share {
            background-color: var(--facebook-blue);
        }
        
        .instagram-share {
            background-color: var(--instagram-purple);
        }
        
        .copy-link-share {
            background-color: #4285f4;
        }
        
        .share-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        
        .whatsapp-share:hover {
            background-color: #1da851;
        }
        
        .facebook-share:hover {
            background-color: #166fe5;
        }
        
        .instagram-share:hover {
            background-color: #d32a50;
        }
        
        .copy-link-share:hover {
            background-color: #3367d6;
        }
        
        /* Forms */
        .form-container {
            max-width: 500px;
            margin: 2rem auto;
            padding: 2rem;
            background-color: var(--card-bg);
            border-radius: 8px;
            box-shadow: var(--shadow);
            transition: var(--transition);
        }
        
        .form-group {
            margin-bottom: 1.5rem;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: var(--text);
        }
        
        .form-control {
            width: 100%;
            padding: 0.8rem;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            font-size: 1rem;
            background-color: var(--input-bg);
            color: var(--text);
            transition: var(--transition);
        }
        
        select.form-control {
            cursor: pointer;
        }
        
        /* Admin Controls */
        .admin-controls {
            background-color: var(--light);
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 2rem;
            display: flex;
            flex-wrap: wrap;
            justify-content: space-between;
            align-items: center;
            gap: 10px;
        }
        
        @media (max-width: 768px) {
            .admin-controls {
                flex-direction: column;
                align-items: stretch;
            }
            
            .admin-controls > div {
                display: flex;
                flex-wrap: wrap;
                gap: 10px;
                justify-content: center;
            }
            
            .admin-controls .btn {
                flex: 1;
                min-width: 140px;
                text-align: center;
                padding: 10px 5px;
                font-size: 0.85rem;
            }
        }
        
        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        
        .modal-content {
            background-color: var(--modal-bg);
            padding: 2rem;
            border-radius: 8px;
            width: 90%;
            max-width: 500px;
            max-height: 90vh;
            overflow-y: auto;
            transition: var(--transition);
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }
        
        .close-modal {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--primary);
        }
        
        /* Footer */
        footer {
            background: var(--footer-bg);
            color: white;
            padding: 3rem 0 2rem;
            margin-top: 3rem;
            transition: var(--transition);
        }
        
        .footer-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 2rem;
        }
        
        .footer-section h3 {
            margin-bottom: 1.5rem;
            font-size: 1.3rem;
        }
        
        .footer-section p {
            margin-bottom: 1rem;
        }
        
        .footer-bottom {
            text-align: center;
            padding-top: 2rem;
            margin-top: 2rem;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                text-align: center;
                gap: 1rem;
            }
            
            .hero h1 {
                font-size: 2rem;
            }
            
            .admin-controls {
                flex-direction: column;
                gap: 1rem;
            }
            
            .categories-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .product-modal-content {
                max-height: 95vh;
            }
            
            .product-modal-action-btn {
                min-width: 100%;
            }
            
            .share-btn {
                min-width: calc(50% - 5px);
            }
        }

        /* Loading Spinner */
        .spinner {
            border: 4px solid rgba(0, 0, 0, 0.1);
            border-left-color: var(--primary);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 2rem auto;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Upload de imagem */
        .image-upload-container {
            margin-bottom: 1.5rem;
        }
        
        .image-preview-container {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 1rem;
        }
        
        .image-preview {
            width: 100px;
            height: 100px;
            border-radius: 4px;
            overflow: hidden;
            position: relative;
            border: 1px solid var(--border-color);
        }
        
        .image-preview img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .remove-image {
            position: absolute;
            top: 5px;
            right: 5px;
            background: rgba(255, 255, 255, 0.8);
            border: none;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            font-size: 12px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .upload-btn-wrapper {
            position: relative;
            overflow: hidden;
            display: inline-block;
            cursor: pointer;
            width: 100%;
            margin-bottom: 1rem;
        }
        
        .upload-btn-wrapper .btn {
            border: 1px solid var(--border-color);
            color: var(--text);
            background-color: var(--input-bg);
            padding: 8px 20px;
            border-radius: 4px;
            font-size: 14px;
            font-weight: normal;
            width: 100%;
            text-align: center;
        }
        
        .upload-btn-wrapper input[type=file] {
            position: absolute;
            left: 0;
            top: 0;
            opacity: 0;
            cursor: pointer;
            width: 100%;
            height: 100%;
        }

        /* Gallery Modal */
        .gallery-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.9);
            z-index: 1100;
            justify-content: center;
            align-items: center;
        }
        
        .gallery-content {
            width: 90%;
            max-width: 800px;
            max-height: 90vh;
            position: relative;
        }
        
        .gallery-main-image {
            width: 100%;
            max-height: 70vh;
            object-fit: contain;
            border-radius: 4px;
        }
        
        .gallery-thumbnails {
            display: flex;
            gap: 10px;
            margin-top: 15px;
            overflow-x: auto;
            padding: 10px 0;
        }
        
        .gallery-thumbnail {
            width: 80px;
            height: 80px;
            border-radius: 4px;
            overflow: hidden;
            cursor: pointer;
            opacity: 0.6;
            transition: var(--transition);
        }
        
        .gallery-thumbnail:hover, .gallery-thumbnail.active {
            opacity: 1;
            transform: scale(1.05);
        }
        
        .gallery-thumbnail img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .gallery-nav {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(204, 0, 0, 0.7);
            border: none;
            color: white;
            font-size: 24px;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
        }
        
        .gallery-nav:hover {
            background: rgba(204, 0, 0, 0.9);
        }
        
        .gallery-prev {
            left: -70px;
        }
        
        .gallery-next {
            right: -70px;
        }
        
        .gallery-close {
            position: absolute;
            top: -40px;
            right: 0;
            background: none;
            border: none;
            color: white;
            font-size: 30px;
            cursor: pointer;
        }
        
        .image-count {
            position: absolute;
            bottom: 10px;
            left: 10px;
            background: rgba(0, 0, 0, 0.5);
            color: white;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 14px;
        }
        
        /* Alertas */
        .alert {
            padding: 12px 16px;
            border-radius: 4px;
            margin: 16px 0;
            display: flex;
            align-items: center;
            background-color: var(--light);
            color: var(--text);
        }
        
        .alert-info {
            border-left: 4px solid var(--primary);
        }
        
        .alert-warning {
            border-left: 4px solid var(--warning);
        }
        
        .alert i {
            margin-right: 10px;
            font-size: 20px;
        }

        /* Badge para número de imagens */
        .image-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            background: var(--primary);
            color: white;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: bold;
        }

        /* Sidebar */
        .sidebar {
            position: fixed;
            top: 0;
            left: -250px;
            width: 250px;
            height: 100vh;
            background: var(--sidebar-bg);
            color: white;
            transition: var(--transition);
            z-index: 1001;
            box-shadow: 2px 0 10px rgba(0, 0, 0, 0.1);
        }

        .sidebar.active {
            left: 0;
        }

        .sidebar-header {
            padding: 1.5rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
        }

        .sidebar-logo {
            font-family: 'Montserrat', sans-serif;
            font-size: 1.2rem;
            font-weight: 700;
            display: flex;
            align-items: center;
        }

        .sidebar-logo i {
            color: var(--secondary);
            margin-right: 0.5rem;
        }

        .sidebar-menu {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .sidebar-menu li {
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .sidebar-menu li:last-child {
            border-bottom: none;
        }

        .sidebar-menu a {
            display: flex;
            align-items: center;
            padding: 1rem 1.5rem;
            color: white;
            text-decoration: none;
            font-weight: 500;
            transition: var(--transition);
        }

        .sidebar-menu a:hover {
            background-color: rgba(255, 255, 255, 0.1);
            color: var(--secondary);
        }

        .sidebar-menu a.active {
            background-color: var(--accent);
            color: white;
        }

        .sidebar-menu i {
            margin-right: 1rem;
            width: 20px;
            text-align: center;
        }

        /* Sidebar Toggle Button */
        .sidebar-toggle {
            position: fixed;
            top: 15px;
            left: 15px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 4px;
            padding: 12px;
            cursor: pointer;
            z-index: 1002;
            box-shadow: var(--shadow);
            transition: var(--transition);
            font-size: 16px;
        }

        .sidebar-toggle:hover {
            background-color: var(--accent);
        }

        /* Sidebar Overlay */
        .sidebar-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: var(--transition);
        }

        .sidebar-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        /* Ajustar conteúdo principal quando sidebar estiver ativo */
        body.sidebar-open {
            overflow: hidden;
        }

        /* Submenu de Categorias no Sidebar */
        .sidebar-submenu {
            display: none;
            background-color: rgba(0, 0, 0, 0.1);
            padding-left: 2rem;
        }

        .sidebar-submenu.active {
            display: block;
        }

        .sidebar-submenu li {
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }

        .sidebar-submenu li:last-child {
            border-bottom: none;
        }

        .sidebar-submenu a {
            padding: 0.8rem 1.5rem;
            font-size: 0.9rem;
        }

        .sidebar-submenu a i {
            font-size: 0.8rem;
        }

        /* Responsive adjustments for sidebar */
        @media (max-width: 768px) {
            .sidebar {
                width: 280px;
                left: -280px;
            }
            
            .sidebar-toggle {
                top: 10px;
                left: 10px;
                padding: 10px;
            }
        }
        
        @media (max-width: 480px) {
            .sidebar {
                width: 45%;
                left: -45%;
            }
        }

        /* Toast de notificação */
        .toast {
            position: fixed;
            bottom: 20px;
            right: 20px;
            padding: 15px 20px;
            border-radius: 4px;
            background-color: #333;
            color: white;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            z-index: 2000;
            display: flex;
            align-items: center;
            opacity: 0;
            transform: translateY(100px);
            transition: opacity 0.3s, transform 0.3s;
        }
        
        .toast.show {
            opacity: 1;
            transform: translateY(0);
        }
        
        .toast.success {
            background-color: var(--success);
        }
        
        .toast.error {
            background-color: var(--accent);
        }
        
        .toast i {
            margin-right: 10px;
            font-size: 20px;
        }
        
        /* Buttons */
        .btn {
            display: inline-block;
            padding: 0.8rem 1.5rem;
            border-radius: 4px;
            text-decoration: none;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            border: none;
            font-size: 1rem;
        }
        
        .btn-primary {
            background: var(--primary);
            color: white;
        }
        
        .btn-primary:hover {
            background-color: var(--accent);
        }
        
        .btn-secondary {
            background-color: var(--accent);
            color: white;
        }
        
        .btn-secondary:hover {
            background-color: var(--primary);
            filter: brightness(0.9);
        }
        
        .btn-outline {
            background-color: transparent;
            border: 2px solid white;
            color: white;
        }
        
        .btn-outline:hover {
            background-color: white;
            color: var(--primary);
        }

        /* Botão de criar categoria */
        .create-category-btn {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        /* Grid de categorias (para admin) */
        .categories-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
            padding: 1rem;
            background-color: var(--light);
            border-radius: 8px;
        }
        
        .category-admin-card {
            background: var(--card-bg);
            border-radius: 8px;
            padding: 1rem;
            text-align: center;
            box-shadow: var(--shadow);
            position: relative;
        }
        
        .category-admin-card .emoji {
            font-size: 2rem;
            margin-bottom: 0.5rem;
        }
        
        .category-admin-card .name {
            font-weight: 500;
            margin-bottom: 0.5rem;
            color: var(--text);
        }
        
        .category-admin-card .delete-btn {
            background: var(--accent);
            color: white;
            border: none;
            border-radius: 4px;
            padding: 0.3rem 0.8rem;
            font-size: 0.8rem;
            cursor: pointer;
            transition: var(--transition);
        }
        
        .category-admin-card .delete-btn:hover {
            background: var(--primary);
            filter: brightness(0.9);
        }

        /* Exemplos de emojis */
        .emoji-examples {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            margin-top: 0.5rem;
            font-size: 1.2rem;
        }
        
        .emoji-example {
            cursor: pointer;
            padding: 5px;
            border-radius: 4px;
            transition: var(--transition);
            background-color: var(--light);
        }
        
        .emoji-example:hover {
            background-color: var(--primary);
            color: white;
            transform: scale(1.2);
        }
        
        /* Leia mais */
        .read-more {
            color: var(--primary);
            font-weight: 500;
            font-size: 0.85rem;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 3px;
            margin-top: 3px;
        }
        
        .read-more:hover {
            text-decoration: underline;
        }

        /* Botão de mostrar/esconder subcategorias */
        .sidebar-menu-toggle {
            margin-left: auto;
            transition: var(--transition);
        }
        
        .sidebar-menu-toggle.rotated {
            transform: rotate(90deg);
        }
        
        /* Controles rápidos de estoque */
        .stock-controls {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 10px;
        }
        
        .stock-quantity {
            font-weight: bold;
            font-size: 1.1rem;
            min-width: 40px;
            text-align: center;
            color: var(--text);
        }
        
        .stock-btn {
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 4px;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-weight: bold;
            transition: var(--transition);
        }
        
        .stock-btn:hover {
            background-color: var(--accent);
        }
        
        /* Botão de WhatsApp personalizável */
        .whatsapp-btn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background-color: var(--whatsapp-green);
            color: white;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 28px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
            z-index: 999;
            cursor: pointer;
            transition: var(--transition);
            animation: pulse 2s infinite;
        }
        
        .whatsapp-btn:hover {
            transform: scale(1.1);
            animation: none;
        }
        
        /* Configurações admin */
        .admin-settings {
            background-color: var(--light);
            padding: 1.5rem;
            border-radius: 8px;
            margin-bottom: 1rem;
        }
        
        .admin-settings-title {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 1.5rem;
            color: var(--primary);
            border-bottom: 2px solid var(--primary);
            padding-bottom: 0.5rem;
        }
        
        .settings-section {
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid var(--border-color);
        }
        
        .settings-section h4 {
            color: var(--text);
            margin-bottom: 0.75rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .settings-section h4 i {
            color: var(--primary);
        }
        
        .form-row {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-bottom: 1rem;
        }
        
        .form-row .form-group {
            flex: 1;
            min-width: 200px;
        }
        
        /* Controle de edição rápida */
        .quick-edit-controls {
            display: flex;
            gap: 10px;
            margin-top: 10px;
            flex-wrap: wrap;
        }
        
        .quick-edit-btn {
            background-color: var(--warning);
            color: white;
            border: none;
            border-radius: 4px;
            padding: 5px 10px;
            font-size: 0.8rem;
            cursor: pointer;
            transition: var(--transition);
        }
        
        .quick-edit-btn:hover {
            background-color: #e67e22;
        }
        
        /* Mensagem de busca vazia */
        .search-empty {
            grid-column: 1 / -1;
            text-align: center;
            padding: 3rem 1rem;
        }
        
        .search-empty i {
            font-size: 3rem;
            color: var(--text-light);
            margin-bottom: 1rem;
        }
        
        .search-empty h3 {
            color: var(--text);
        }
        
        .search-empty p {
            color: var(--text-light);
        }
        
        /* Botão de cópia de link */
        .copy-link-btn {
            background-color: #4285f4;
            color: white;
            border: none;
            border-radius: 4px;
            padding: 5px 10px;
            font-size: 0.8rem;
            cursor: pointer;
            transition: var(--transition);
        }
        
        .copy-link-btn:hover {
            background-color: #3367d6;
        }
        
        /* Título de seção de compartilhamento */
        .share-section-title {
            margin-top: 1.5rem;
            margin-bottom: 0.5rem;
            font-size: 1.1rem;
            color: var(--text);
        }
        
        /* Estatísticas de sistema */
        .system-stats {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-bottom: 1.5rem;
        }
        
        .stat-card {
            flex: 1;
            min-width: 150px;
            background: var(--card-bg);
            border-radius: 8px;
            padding: 1rem;
            box-shadow: var(--shadow);
            border-left: 4px solid var(--primary);
        }
        
        .stat-card h5 {
            font-size: 0.9rem;
            color: var(--text-light);
            margin-bottom: 0.5rem;
        }
        
        .stat-card p {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--primary);
        }
        
        .stat-card .stat-detail {
            font-size: 0.8rem;
            color: var(--text-light);
            margin-top: 0.25rem;
        }
        
        /* Controles de exibição */
        .display-controls {
            display: flex;
            gap: 10px;
            margin-bottom: 1rem;
            flex-wrap: wrap;
        }
        
        .display-control-btn {
            background-color: var(--light);
            border: 1px solid var(--border-color);
            padding: 8px 15px;
            border-radius: 4px;
            cursor: pointer;
            transition: var(--transition);
            font-size: 0.9rem;
            color: var(--text);
        }
        
        .display-control-btn.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }
        
        .display-control-btn:hover {
            background: var(--primary);
            color: white;
        }
        
        /* Botão de exportação */
        .export-btn {
            background-color: var(--success);
            color: white;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        
        .export-btn:hover {
            background-color: #219653;
        }
        
        /* Toggle switch para configurações */
        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 30px;
            margin-right: 10px;
        }
        
        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 34px;
        }
        
        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 22px;
            width: 22px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        
        input:checked + .toggle-slider {
            background-color: var(--success);
        }
        
        input:checked + .toggle-slider:before {
            transform: translateX(30px);
        }
        
        .toggle-label {
            display: flex;
            align-items: center;
            margin-bottom: 0.5rem;
            color: var(--text);
        }
        
        /* Configurações de tema */
        .theme-preview {
            display: flex;
            gap: 10px;
            margin-top: 0.5rem;
            flex-wrap: wrap;
        }
        
        .theme-color {
            width: 40px;
            height: 40px;
            border-radius: 8px;
            cursor: pointer;
            border: 3px solid transparent;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
        }
        
        .theme-color.selected {
            border-color: var(--dark);
            transform: scale(1.1);
        }
        
        /* Novo: Seleção de tema completo */
        .theme-selector {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-top: 1rem;
        }
        
        .theme-option {
            width: 120px;
            height: 90px;
            border-radius: 8px;
            overflow: hidden;
            cursor: pointer;
            border: 3px solid transparent;
            transition: var(--transition);
            position: relative;
        }
        
        .theme-option.selected {
            border-color: var(--primary);
            transform: scale(1.05);
        }
        
        .theme-preview-colors {
            display: flex;
            height: 100%;
        }
        
        .theme-preview-color {
            flex: 1;
            height: 100%;
        }
        
        .theme-option-name {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 5px;
            font-size: 0.8rem;
            text-align: center;
        }
        
        /* Preço antigo acima do preço atual */
        .price-old-above {
            display: flex;
            flex-direction: column;
            margin-bottom: 1rem;
        }
        
        .price-old-above .old-price {
            color: var(--primary);
            text-decoration: line-through;
            font-size: 1.1rem;
            margin-bottom: 0.25rem;
        }
        
        .price-old-above .current-price {
            color: var(--text);
            font-size: 2rem;
            font-weight: 700;
        }
    </style>
</head>
<body class="theme-light">
    <!-- Toast de notificação -->
    <div id="toast" class="toast">
        <i class="fas fa-check-circle"></i>
        <span id="toast-message"></span>
    </div>

    <!-- Botão do WhatsApp -->
    <div class="whatsapp-btn" id="whatsapp-btn">
        <i class="fab fa-whatsapp"></i>
    </div>
    
    <!-- Modal de Produto Expandido -->
    <div id="product-modal" class="product-modal">
        <div class="product-modal-content">
            <button class="product-modal-close">&times;</button>
            <div class="product-modal-body">
                <div class="product-modal-images">
                    <div class="product-modal-main-image">
                        <img id="product-modal-main-img" src="" alt="Imagem do produto">
                    </div>
                    <div class="product-modal-thumbnails" id="product-modal-thumbnails">
                        <!-- Thumbnails serão adicionados aqui -->
                    </div>
                </div>
                <div class="product-modal-info">
                    <h1 class="product-modal-title" id="product-modal-title"></h1>
                    <div id="product-modal-price-container">
                        <!-- Preços serão adicionados aqui -->
                    </div>
                    <div class="product-modal-stock" id="product-modal-stock"></div>
                    <p class="product-modal-description" id="product-modal-description"></p>
                    <div class="product-modal-features" id="product-modal-features">
                        <!-- Features serão adicionadas aqui -->
                    </div>
                    <div class="product-modal-actions" id="product-modal-actions">
                        <!-- Ações serão adicionadas aqui -->
                    </div>
                    
                    <!-- Seção de compartilhamento -->
                    <h3 class="share-section-title">Compartilhar este produto:</h3>
                    <div class="share-buttons" id="share-buttons">
                        <!-- Botões de compartilhamento serão adicionados aqui -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de Edição Rápida de Estoque -->
    <div id="quick-stock-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Atualizar Estoque</h2>
                <button class="close-modal">&times;</button>
            </div>
            <form id="quick-stock-form">
                <div class="form-group">
                    <label id="quick-stock-product-name"></label>
                    <div class="stock-controls" style="justify-content: center;">
                        <button type="button" class="stock-btn" id="decrease-stock">-</button>
                        <input type="number" id="quick-stock-quantity" class="form-control" style="width: 100px; text-align: center;" min="0">
                        <button type="button" class="stock-btn" id="increase-stock">+</button>
                    </div>
                </div>
                <input type="hidden" id="quick-stock-product-id">
                <button type="submit" class="btn btn-primary">Atualizar Estoque</button>
            </form>
        </div>
    </div>

    <!-- Sidebar Toggle Button -->
    <button class="sidebar-toggle" id="sidebar-toggle">
        <i class="fas fa-bars"></i>
    </button>

    <!-- Sidebar Overlay -->
    <div class="sidebar-overlay" id="sidebar-overlay"></div>

    <!-- Sidebar -->
    <div class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <div class="sidebar-logo">
                <i class="fas fa-boxes"></i>
                <span>Menu</span>
            </div>
        </div>
        <ul class="sidebar-menu">
            <li>
                <a href="#" class="active" data-section="inicio">
                    <i class="fas fa-home"></i>
                    <span>Início</span>
                </a>
            </li>
            <li>
                <a href="#" data-section="produtos">
                    <i class="fas fa-box"></i>
                    <span>Produtos</span>
                </a>
            </li>
            <li class="has-submenu">
                <a href="#" id="sidebar-categories-toggle">
                    <i class="fas fa-tags"></i>
                    <span>Categorias</span>
                    <i class="fas fa-chevron-right sidebar-menu-toggle"></i>
                </a>
                <ul class="sidebar-submenu" id="sidebar-categories-submenu">
                    <li>
                        <a href="#" data-category="all">
                            <i class="fas fa-th-large"></i>
                            <span>Todos os Produtos</span>
                        </a>
                    </li>
                    <!-- Categorias serão carregadas dinamicamente aqui -->
                </ul>
            </li>
            <li>
                <a href="#" data-section="contato">
                    <i class="fas fa-envelope"></i>
                    <span>Contato</span>
                </a>
            </li>
            <li>
                <a href="#" data-section="login" id="sidebar-login-link">
                    <i class="fas fa-sign-in-alt"></i>
                    <span>Login</span>
                </a>
            </li>
        </ul>
    </div>

    <!-- Header -->
    <header>
        <div class="container header-content">
            <div class="logo">
                <i class="fas fa-boxes"></i>
                <span>Guara Estoque</span>
            </div>
            <div class="search-container">
                <input type="text" id="search-input" class="search-input" placeholder="Buscar produtos...">
                <button class="search-button" id="search-button">
                    <i class="fas fa-search"></i>
                </button>
            </div>
        </div>
    </header>

    <!-- Hero Section -->
    <section class="hero">
        <div class="container">
            <h1>Guara Estoque - A melhor opção de Guarapari</h1>
            <p>Para quem busca variedade, bom atendimento e uma experiência de compra prática e confiável.</p>
            <a href="#products-section" class="btn btn-outline" id="view-products-btn">Ver Produtos</a>
        </div>
    </section>

    <!-- Main Content -->
    <main class="container">
        <!-- Admin Controls (visible only when logged in) -->
        <div id="admin-controls" class="admin-controls" style="display: none;">
            <h3>Painel do Administrador</h3>
            <div>
                <button id="add-product-btn" class="btn btn-primary">
                    <i class="fas fa-plus"></i> Adicionar Produto
                </button>
                <button id="add-category-btn" class="btn btn-secondary create-category-btn">
                    <i class="fas fa-plus-circle"></i> Criar Categoria
                </button>
                <button id="manage-categories-btn" class="btn btn-secondary">
                    <i class="fas fa-cog"></i> Gerenciar Categorias
                </button>
                <button id="admin-settings-btn" class="btn btn-secondary">
                    <i class="fas fa-sliders-h"></i> Configurações
                </button>
                <button id="logout-btn" class="btn btn-secondary">
                    <i class="fas fa-sign-out-alt"></i> Sair
                </button>
            </div>
        </div>
        
        <!-- Configurações Admin - EXPANDIDA -->
        <div id="admin-settings-section" class="admin-settings" style="display: none;">
            <div class="admin-settings-title">
                <i class="fas fa-sliders-h"></i>
                <h3>Configurações do Sistema</h3>
            </div>
            
            <!-- Estatísticas do Sistema -->
            <div class="system-stats">
                <div class="stat-card">
                    <h5>Produtos Cadastrados</h5>
                    <p id="stat-products">0</p>
                </div>
                <div class="stat-card">
                    <h5>Categorias</h5>
                    <p id="stat-categories">0</p>
                </div>
                <div class="stat-card">
                    <h5>Última Atualização</h5>
                    <p id="stat-last-update">-</p>
                    <div class="stat-detail" id="stat-last-update-detail">Data: -</div>
                </div>
            </div>
            
            <!-- Configurações Gerais -->
            <div class="settings-section">
                <h4><i class="fas fa-cog"></i> Configurações Gerais</h4>
                <div class="form-row">
                    <div class="form-group">
                        <label for="system-name">Nome do Sistema</label>
                        <input type="text" id="system-name" class="form-control" value="Guara Estoque">
                    </div>
                    <div class="form-group">
                        <label for="system-slogan">Slogan</label>
                        <input type="text" id="system-slogan" class="form-control" value="A melhor opção de Guarapari">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="system-currency">Moeda</label>
                        <select id="system-currency" class="form-control">
                            <option value="R$">Real Brasileiro (R$)</option>
                            <option value="US$">Dólar Americano (US$)</option>
                            <option value="€">Euro (€)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="system-timezone">Fuso Horário</label>
                        <select id="system-timezone" class="form-control">
                            <option value="America/Sao_Paulo">Brasília (GMT-3)</option>
                            <option value="UTC">UTC</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label for="system-description">Descrição do Sistema</label>
                    <textarea id="system-description" class="form-control" rows="3">Sistema completo de controle de inventário e gestão de produtos para sua empresa.</textarea>
                </div>
            </div>
            
            <!-- Configurações de Tema -->
            <div class="settings-section">
                <h4><i class="fas fa-palette"></i> Configurações de Tema</h4>
                <div class="form-group">
                    <label>Seleção de Tema Completo</label>
                    <div class="theme-selector" id="theme-selector">
                        <!-- Temas serão carregados dinamicamente -->
                    </div>
                </div>
                <div class="form-group">
                    <label>Modo de Visualização</label>
                    <div class="form-row">
                        <div class="form-group">
                            <div class="toggle-label">
                                <label class="toggle-switch">
                                    <input type="checkbox" id="dark-mode">
                                    <span class="toggle-slider"></span>
                                </label>
                                <span>Modo escuro</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Configurações de API (Firebase e ImgBB) -->
            <div class="settings-section">
                <h4><i class="fas fa-key"></i> Configurações de API</h4>
                <div class="alert alert-info">
                    <i class="fas fa-info-circle"></i>
                    <strong>Importante:</strong> Configure suas chaves de API para que o sistema funcione corretamente.
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="firebase-api-key">Firebase API Key</label>
                        <input type="text" id="firebase-api-key" class="form-control" value="AIzaSyBP1YYeAluvIJMwwlB3rtKbVUUbx1riqUc">
                    </div>
                    <div class="form-group">
                        <label for="firebase-auth-domain">Firebase Auth Domain</label>
                        <input type="text" id="firebase-auth-domain" class="form-control" value="corretora777.firebaseapp.com">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="firebase-project-id">Firebase Project ID</label>
                        <input type="text" id="firebase-project-id" class="form-control" value="corretora777">
                    </div>
                    <div class="form-group">
                        <label for="firebase-storage-bucket">Firebase Storage Bucket</label>
                        <input type="text" id="firebase-storage-bucket" class="form-control" value="corretora777.appspot.com">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="firebase-messaging-sender-id">Firebase Messaging Sender ID</label>
                        <input type="text" id="firebase-messaging-sender-id" class="form-control" value="217992558412">
                    </div>
                    <div class="form-group">
                        <label for="firebase-app-id">Firebase App ID</label>
                        <input type="text" id="firebase-app-id" class="form-control" value="1:217992558412:web:your-app-id-here">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="imgbb-api-key">ImgBB API Key</label>
                        <input type="text" id="imgbb-api-key" class="form-control" value="f08cc6805510ac32c5ecdb6f5ed51689">
                        <small>API Key para upload de imagens no ImgBB</small>
                    </div>
                </div>
            </div>
            
            <!-- Contato e WhatsApp -->
            <div class="settings-section">
                <h4><i class="fas fa-phone-alt"></i> Configurações de Contato</h4>
                <div class="form-row">
                    <div class="form-group">
                        <label for="whatsapp-number">Número do WhatsApp (com DDD)</label>
                        <input type="text" id="whatsapp-number" class="form-control" placeholder="5527996316212" value="5527996316212">
                    </div>
                    <div class="form-group">
                        <label for="contact-email">E-mail de Contato</label>
                        <input type="email" id="contact-email" class="form-control" value="contato@guaraestoque.com">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="contact-phone">Telefone Fixo</label>
                        <input type="text" id="contact-phone" class="form-control" placeholder="(27) 3333-3333">
                    </div>
                    <div class="form-group">
                        <label for="contact-address">Endereço</label>
                        <input type="text" id="contact-address" class="form-control" value="Av. Comercial, 1234, Centro, Guarapari-ES">
                    </div>
                </div>
                <div class="form-group">
                    <label for="whatsapp-message">Mensagem Padrão do WhatsApp</label>
                    <textarea id="whatsapp-message" class="form-control" rows="2">Olá! Vi seu produto no Guara Estoque e gostaria de mais informações.</textarea>
                </div>
            </div>
            
            <!-- Configurações de Exibição -->
            <div class="settings-section">
                <h4><i class="fas fa-eye"></i> Configurações de Exibição</h4>
                <div class="form-row">
                    <div class="form-group">
                        <div class="toggle-label">
                            <label class="toggle-switch">
                                <input type="checkbox" id="show-stock-status" checked>
                                <span class="toggle-slider"></span>
                            </label>
                            <span>Mostrar status do estoque</span>
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="toggle-label">
                            <label class="toggle-switch">
                                <input type="checkbox" id="show-product-features" checked>
                                <span class="toggle-slider"></span>
                            </label>
                            <span>Mostrar características dos produtos</span>
                        </div>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <div class="toggle-label">
                            <label class="toggle-switch">
                                <input type="checkbox" id="show-categories-sidebar" checked>
                                <span class="toggle-slider"></span>
                            </label>
                            <span>Mostrar categorias na sidebar</span>
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="toggle-label">
                            <label class="toggle-switch">
                                <input type="checkbox" id="enable-search" checked>
                                <span class="toggle-slider"></span>
                            </label>
                            <span>Habilitar busca</span>
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <label>Itens por página</label>
                    <div class="display-controls">
                        <button type="button" class="display-control-btn active" data-items="12">12</button>
                        <button type="button" class="display-control-btn" data-items="24">24</button>
                        <button type="button" class="display-control-btn" data-items="36">36</button>
                        <button type="button" class="display-control-btn" data-items="48">48</button>
                    </div>
                </div>
            </div>
            
            <!-- Backup e Exportação -->
            <div class="settings-section">
                <h4><i class="fas fa-database"></i> Backup e Exportação</h4>
                <div class="form-row">
                    <div class="form-group">
                        <button id="export-products-btn" class="btn export-btn">
                            <i class="fas fa-file-export"></i> Exportar Produtos (CSV)
                        </button>
                    </div>
                    <div class="form-group">
                        <button id="backup-system-btn" class="btn btn-secondary">
                            <i class="fas fa-save"></i> Backup do Sistema
                        </button>
                    </div>
                </div>
                <div class="form-group">
                    <label for="backup-frequency">Frequência de Backup Automático</label>
                    <select id="backup-frequency" class="form-control">
                        <option value="daily">Diariamente</option>
                        <option value="weekly">Semanalmente</option>
                        <option value="monthly">Mensalmente</option>
                        <option value="never">Nunca</option>
                    </select>
                </div>
            </div>
            
            <div class="form-row">
                <button class="btn btn-primary" id="save-system-settings">
                    <i class="fas fa-save"></i> Salvar Todas as Configurações
                </button>
                <button class="btn btn-secondary" id="reset-system-settings">
                    <i class="fas fa-undo"></i> Restaurar Padrões
                </button>
            </div>
        </div>

        <!-- Products Listing -->
        <h2 id="products-section">Produtos em Estoque</h2>
        <div id="products-grid" class="products-grid">
            <div class="spinner" id="loading-spinner"></div>
            <!-- Products will be loaded here dynamically -->
        </div>

        <!-- Categories Management (visible only when logged in) -->
        <div id="categories-management" style="display: none; margin-top: 3rem;">
            <h2>Gerenciar Categorias</h2>
            <div id="categories-grid" class="categories-grid">
                <!-- Categorias em modo de gerenciamento serão carregadas aqui -->
            </div>
        </div>
    </main>

    <!-- Login Modal -->
    <div id="login-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Login do Administrador</h2>
                <button class="close-modal">&times;</button>
            </div>
            <form id="login-form">
                <div class="form-group">
                    <label for="email">E-mail</label>
                    <input type="email" id="email" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="password">Senha</label>
                    <input type="password" id="password" class="form-control" required>
                </div>
                <button type="submit" class="btn btn-primary">Entrar</button>
                <p id="login-message" style="margin-top: 1rem; color: var(--primary);"></p>
            </form>
        </div>
    </div>

    <!-- Add/Edit Product Modal -->
    <div id="add-product-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="product-modal-title">Adicionar Novo Produto</h2>
                <button class="close-modal">&times;</button>
            </div>
            <form id="product-form">
                <input type="hidden" id="edit-product-id">
                <div class="form-group">
                    <label for="product-title">Nome do Produto</label>
                    <input type="text" id="product-title" class="form-control" required>
                </div>
                <div class="form-group">
                    <label for="product-price">Preço Promocional (R$)</label>
                    <input type="number" id="product-price" class="form-control" required step="0.01">
                </div>
                <div class="form-group">
                    <label for="product-old-price">Preço Original (opcional - para exibir desconto)</label>
                    <input type="number" id="product-old-price" class="form-control" step="0.01">
                    <small>Se preenchido, será exibido o percentual de desconto</small>
                </div>
                <div class="form-group">
                    <label for="product-category">Categoria</label>
                    <select id="product-category" class="form-control" required>
                        <option value="">Selecione uma categoria</option>
                        <!-- Categorias serão carregadas dinamicamente -->
                    </select>
                </div>
                <div class="form-group">
                    <label for="product-description">Descrição</label>
                    <textarea id="product-description" class="form-control" rows="3" required></textarea>
                </div>
                <div class="form-group">
                    <label for="product-stock">Quantidade em Estoque</label>
                    <input type="number" id="product-stock" class="form-control" required min="0">
                </div>
                <div class="form-group">
                    <label for="product-brand">Marca (opcional)</label>
                    <input type="text" id="product-brand" class="form-control">
                </div>
                <div class="form-group image-upload-container">
                    <label for="product-image-upload">Imagens do Produto (Múltiplas)</label>
                    <div class="upload-btn-wrapper">
                        <button class="btn"><i class="fas fa-upload"></i> Selecione as imagens</button>
                        <input type="file" id="product-image-upload" accept="image/*" multiple>
                    </div>
                    <div class="image-preview-container" id="image-preview-container">
                        <!-- Image previews will be added here -->
                    </div>
                </div>
                <button type="submit" class="btn btn-primary" id="product-form-submit">Adicionar Produto</button>
                <p id="product-message" style="margin-top: 1rem;"></p>
            </form>
        </div>
    </div>

    <!-- Add Category Modal -->
    <div id="add-category-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Criar Nova Categoria</h2>
                <button class="close-modal">&times;</button>
            </div>
            <form id="category-form">
                <div class="form-group">
                    <label for="category-name">Nome da Categoria</label>
                    <input type="text" id="category-name" class="form-control" required placeholder="Ex: Eletrônicos, Móveis, Roupas">
                </div>
                <div class="form-group">
                    <label for="category-emoji">Emoji da Categoria</label>
                    <input type="text" id="category-emoji" class="form-control" required placeholder="Ex: 📱 para Eletrônicos" maxlength="2">
                    <small>Digite um emoji que represente a categoria. Exemplos:</small>
                    <div class="emoji-examples">
                        <span class="emoji-example" onclick="document.getElementById('category-emoji').value = '📱'">📱</span>
                        <span class="emoji-example" onclick="document.getElementById('category-emoji').value = '👕'">👕</span>
                        <span class="emoji-example" onclick="document.getElementById('category-emoji').value = '🛋️'">🛋️</span>
                        <span class="emoji-example" onclick="document.getElementById('category-emoji').value = '🏀'">🏀</span>
                        <span class="emoji-example" onclick="document.getElementById('category-emoji').value = '🍽️'">🍽️</span>
                        <span class="emoji-example" onclick="document.getElementById('category-emoji').value = '💻'">💻</span>
                        <span class="emoji-example" onclick="document.getElementById('category-emoji').value = '🎮'">🎮</span>
                        <span class="emoji-example" onclick="document.getElementById('category-emoji').value = '📚'">📚</span>
                        <span class="emoji-example" onclick="document.getElementById('category-emoji').value = '🚗'">🚗</span>
                    </div>
                </div>
                <button type="submit" class="btn btn-primary">Criar Categoria</button>
                <p id="category-message" style="margin-top: 1rem;"></p>
            </form>
        </div>
    </div>

    <!-- Gallery Modal -->
    <div id="gallery-modal" class="gallery-modal">
        <div class="gallery-content">
            <button class="gallery-close">&times;</button>
            <img class="gallery-main-image" id="gallery-main-image" src="" alt="Gallery image">
            <div class="image-count" id="image-count"></div>
            <div class="gallery-thumbnails" id="gallery-thumbnails">
                <!-- Thumbnails will be added here -->
            </div>
            <button class="gallery-nav gallery-prev"><i class="fas fa-chevron-left"></i></button>
            <button class="gallery-nav gallery-next"><i class="fas fa-chevron-right"></i></button>
        </div>
    </div>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3 id="footer-system-name">Guara Estoque</h3>
                    <p id="footer-system-description">Sistema completo de controle de inventário e gestão de produtos para sua empresa.</p>
                </div>
                <div class="footer-section">
                    <h3>Contato</h3>
                    <p><i class="fas fa-map-marker-alt"></i> <span id="footer-address">Av. Comercial, 1234, Centro</span></p>
                    <p><i class="fas fa-phone"></i> <span id="footer-phone">(27) 99631-6212</span></p>
                    <p><i class="fas fa-envelope"></i> <span id="footer-email">contato@guaraestoque.com</span></p>
                </div>
                <div class="footer-section">
                    <h3>Redes Sociais</h3>
                    <p>
                        <a href="#" style="color: white;"><i class="fab fa-facebook"></i> Facebook</a>
                    </p>
                    <p>
                        <a href="#" style="color: white;"><i class="fab fa-instagram"></i> Instagram</a>
                    </p>
                    <p>
                        <a href="#" style="color: white;"><i class="fab fa-whatsapp"></i> WhatsApp</a>
                    </p>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; <span id="current-year"></span> <span id="footer-copyright">Guara Estoque</span> - Todos os direitos reservados</p>
            </div>
        </div>
    </footer>

    <!-- Firebase Configuration and App Logic -->
    <script>
        // Firebase configuration - Inicialmente com valores padrão
        let firebaseConfig = {
            apiKey: "AIzaSyBP1YYeAluvIJMwwlB3rtKbVUUbx1riqUc",
            authDomain: "corretora777.firebaseapp.com",
            projectId: "corretora777",
            storageBucket: "corretora777.appspot.com",
            messagingSenderId: "217992558412",
            appId: "1:217992558412:web:your-app-id-here"
        };
        
        // Configuração do imgBB - Inicialmente com valor padrão
        let IMGBB_API_KEY = 'f08cc6805510ac32c5ecdb6f5ed51689';
        
        // Inicializar Firebase com configurações padrão
        try {
            firebase.initializeApp(firebaseConfig);
        } catch (error) {
            console.error("Erro ao inicializar Firebase:", error);
        }
        
        const auth = firebase.auth();
        const db = firebase.firestore();
        
        // DOM Elements
        const loginModal = document.getElementById('login-modal');
        const addProductModal = document.getElementById('add-product-modal');
        const addCategoryModal = document.getElementById('add-category-modal');
        const galleryModal = document.getElementById('gallery-modal');
        const productModal = document.getElementById('product-modal');
        const quickStockModal = document.getElementById('quick-stock-modal');
        const adminControls = document.getElementById('admin-controls');
        const adminSettingsSection = document.getElementById('admin-settings-section');
        const categoriesManagement = document.getElementById('categories-management');
        const loginForm = document.getElementById('login-form');
        const sidebarLoginLink = document.getElementById('sidebar-login-link');
        const sidebarCategoriesToggle = document.getElementById('sidebar-categories-toggle');
        const sidebarCategoriesSubmenu = document.getElementById('sidebar-categories-submenu');
        const productForm = document.getElementById('product-form');
        const categoryForm = document.getElementById('category-form');
        const quickStockForm = document.getElementById('quick-stock-form');
        const productsGrid = document.getElementById('products-grid');
        const categoriesGrid = document.getElementById('categories-grid');
        const logoutBtn = document.getElementById('logout-btn');
        const addProductBtn = document.getElementById('add-product-btn');
        const addCategoryBtn = document.getElementById('add-category-btn');
        const manageCategoriesBtn = document.getElementById('manage-categories-btn');
        const adminSettingsBtn = document.getElementById('admin-settings-btn');
        const closeModals = document.querySelectorAll('.close-modal');
        const productModalClose = document.querySelector('.product-modal-close');
        const loginMessage = document.getElementById('login-message');
        const productMessage = document.getElementById('product-message');
        const categoryMessage = document.getElementById('category-message');
        const loadingSpinner = document.getElementById('loading-spinner');
        const imageUpload = document.getElementById('product-image-upload');
        const imagePreviewContainer = document.getElementById('image-preview-container');
        const galleryMainImage = document.getElementById('gallery-main-image');
        const galleryThumbnails = document.getElementById('gallery-thumbnails');
        const galleryClose = document.querySelector('.gallery-close');
        const galleryPrev = document.querySelector('.gallery-prev');
        const galleryNext = document.querySelector('.gallery-next');
        const imageCount = document.getElementById('image-count');
        const toast = document.getElementById('toast');
        const toastMessage = document.getElementById('toast-message');
        const productCategorySelect = document.getElementById('product-category');
        const productModalTitle = document.getElementById('product-modal-title');
        const productFormSubmit = document.getElementById('product-form-submit');
        const editProductId = document.getElementById('edit-product-id');
        const productModalPriceContainer = document.getElementById('product-modal-price-container');
        const shareButtonsContainer = document.getElementById('share-buttons');
        const viewProductsBtn = document.getElementById('view-products-btn');
        
        // Elementos do modal de produto expandido
        const productModalMainImg = document.getElementById('product-modal-main-img');
        const productModalThumbnails = document.getElementById('product-modal-thumbnails');
        const productModalTitleElem = document.getElementById('product-modal-title');
        const productModalStock = document.getElementById('product-modal-stock');
        const productModalDescription = document.getElementById('product-modal-description');
        const productModalFeatures = document.getElementById('product-modal-features');
        const productModalActions = document.getElementById('product-modal-actions');
        
        // Elementos do WhatsApp
        const whatsappBtn = document.getElementById('whatsapp-btn');
        const whatsappNumber = document.getElementById('whatsapp-number');
        
        // Elementos do modal de estoque rápido
        const quickStockProductName = document.getElementById('quick-stock-product-name');
        const quickStockQuantity = document.getElementById('quick-stock-quantity');
        const quickStockProductId = document.getElementById('quick-stock-product-id');
        const decreaseStockBtn = document.getElementById('decrease-stock');
        const increaseStockBtn = document.getElementById('increase-stock');
        
        // Elementos de busca
        const searchInput = document.getElementById('search-input');
        const searchButton = document.getElementById('search-button');
        
        // Configurações do sistema - Elementos expandidos
        const systemNameInput = document.getElementById('system-name');
        const systemSloganInput = document.getElementById('system-slogan');
        const systemDescriptionInput = document.getElementById('system-description');
        const systemCurrencyInput = document.getElementById('system-currency');
        const systemTimezoneInput = document.getElementById('system-timezone');
        const contactEmailInput = document.getElementById('contact-email');
        const contactPhoneInput = document.getElementById('contact-phone');
        const contactAddressInput = document.getElementById('contact-address');
        const saveSystemSettingsBtn = document.getElementById('save-system-settings');
        const resetSystemSettingsBtn = document.getElementById('reset-system-settings');
        
        // Configurações de API
        const firebaseApiKeyInput = document.getElementById('firebase-api-key');
        const firebaseAuthDomainInput = document.getElementById('firebase-auth-domain');
        const firebaseProjectIdInput = document.getElementById('firebase-project-id');
        const firebaseStorageBucketInput = document.getElementById('firebase-storage-bucket');
        const firebaseMessagingSenderIdInput = document.getElementById('firebase-messaging-sender-id');
        const firebaseAppIdInput = document.getElementById('firebase-app-id');
        const imgbbApiKeyInput = document.getElementById('imgbb-api-key');
        
        // Configurações de exibição
        const showStockStatus = document.getElementById('show-stock-status');
        const showProductFeatures = document.getElementById('show-product-features');
        const showCategoriesSidebar = document.getElementById('show-categories-sidebar');
        const enableSearch = document.getElementById('enable-search');
        const displayControls = document.querySelectorAll('.display-control-btn');
        
        // Configurações de tema
        const themeSelector = document.getElementById('theme-selector');
        const darkMode = document.getElementById('dark-mode');
        
        // Backup e exportação
        const exportProductsBtn = document.getElementById('export-products-btn');
        const backupSystemBtn = document.getElementById('backup-system-btn');
        const backupFrequency = document.getElementById('backup-frequency');
        
        // Estatísticas
        const statProducts = document.getElementById('stat-products');
        const statCategories = document.getElementById('stat-categories');
        const statLastUpdate = document.getElementById('stat-last-update');
        const statLastUpdateDetail = document.getElementById('stat-last-update-detail');
        
        // Footer elements
        const footerSystemName = document.getElementById('footer-system-name');
        const footerSystemDescription = document.getElementById('footer-system-description');
        const footerAddress = document.getElementById('footer-address');
        const footerPhone = document.getElementById('footer-phone');
        const footerEmail = document.getElementById('footer-email');
        const footerCopyright = document.getElementById('footer-copyright');
        
        // Variáveis globais
        let currentImageIndex = 0;
        let currentGalleryImages = [];
        let selectedFiles = [];
        let currentCategory = 'all';
        let allProducts = [];
        let allCategories = [];
        let isManagingCategories = false;
        let currentProductModalImages = [];
        let currentProductModalIndex = 0;
        let isCategoriesSubmenuOpen = false;
        let isEditingProduct = false;
        let currentEditingProductId = null;
        let currentEditingProductImages = [];
        let currentSearchQuery = '';
        let currentProductForSharing = null;
        let systemSettings = {};
        let itemsPerPage = 12;
        let currentTheme = 'light';
        let currentColor = '#CC0000';
        
        // Configurações do WhatsApp
        let whatsappSettings = {
            number: "5527996316212"
        };

        // Sistema de última atualização
        let lastUpdateData = {
            timestamp: null
        };

        // Sidebar Elements
        const sidebarToggle = document.getElementById('sidebar-toggle');
        const sidebar = document.getElementById('sidebar');
        const sidebarOverlay = document.getElementById('sidebar-overlay');
        const sidebarMenuItems = document.querySelectorAll('.sidebar-menu a:not(.has-submenu a)');

        // Função para mostrar notificação toast
        function showToast(message, type = 'success') {
            toastMessage.textContent = message;
            toast.className = `toast ${type} show`;
            
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }

        // Função para calcular porcentagem de desconto
        function calculateDiscountPercentage(originalPrice, salePrice) {
            if (!originalPrice || originalPrice <= salePrice) return 0;
            return Math.round(((originalPrice - salePrice) / originalPrice) * 100);
        }

        // Função para embaralhar array (Fisher-Yates shuffle)
        function shuffleArray(array) {
            const newArray = [...array];
            for (let i = newArray.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
            }
            return newArray;
        }

        // Definir os temas disponíveis
        const availableThemes = [
            {
                id: 'light',
                name: 'Claro',
                colors: ['#f9f9f9', '#FFFFFF', '#CC0000', '#990000']
            },
            {
                id: 'dark',
                name: 'Escuro',
                colors: ['#121212', '#1e1e1e', '#CC0000', '#990000']
            },
            {
                id: 'blue',
                name: 'Azul',
                colors: ['#f9f9f9', '#FFFFFF', '#0066CC', '#004C99']
            },
            {
                id: 'green',
                name: 'Verde',
                colors: ['#f9f9f9', '#FFFFFF', '#009900', '#007700']
            },
            {
                id: 'purple',
                name: 'Roxo',
                colors: ['#f9f9f9', '#FFFFFF', '#663399', '#552288']
            },
            {
                id: 'orange',
                name: 'Laranja',
                colors: ['#f9f9f9', '#FFFFFF', '#FF6600', '#CC5500']
            },
            {
                id: 'pink',
                name: 'Rosa',
                colors: ['#f9f9f9', '#FFFFFF', '#E91E63', '#C2185B']
            },
            {
                id: 'gray',
                name: 'Cinza',
                colors: ['#f9f9f9', '#FFFFFF', '#607D8B', '#455A64']
            },
            {
                id: 'teal',
                name: 'Verde-azulado',
                colors: ['#f9f9f9', '#FFFFFF', '#008080', '#006666']
            },
            {
                id: 'indigo',
                name: 'Índigo',
                colors: ['#f9f9f9', '#FFFFFF', '#4B0082', '#3A0066']
            },
            {
                id: 'yellow',
                name: 'Amarelo',
                colors: ['#f9f9f9', '#FFFFFF', '#FFD700', '#CCAD00']
            },
            {
                id: 'brown',
                name: 'Marrom',
                colors: ['#f9f9f9', '#FFFFFF', '#8B4513', '#6B3610']
            },
            {
                id: 'cyan',
                name: 'Ciano',
                colors: ['#f9f9f9', '#FFFFFF', '#00BCD4', '#0097A7']
            },
            {
                id: 'lime',
                name: 'Lima',
                colors: ['#f9f9f9', '#FFFFFF', '#CDDC39', '#AFB42B']
            },
            {
                id: 'deep-orange',
                name: 'Laranja Escuro',
                colors: ['#f9f9f9', '#FFFFFF', '#FF5722', '#E64A19']
            },
            {
                id: 'deep-purple',
                name: 'Roxo Escuro',
                colors: ['#f9f9f9', '#FFFFFF', '#673AB7', '#512DA8']
            },
            {
                id: 'light-blue',
                name: 'Azul Claro',
                colors: ['#f9f9f9', '#FFFFFF', '#03A9F4', '#0288D1']
            },
            {
                id: 'light-green',
                name: 'Verde Claro',
                colors: ['#f9f9f9', '#FFFFFF', '#8BC34A', '#689F38']
            },
            {
                id: 'amber',
                name: 'Âmbar',
                colors: ['#f9f9f9', '#FFFFFF', '#FFC107', '#FFA000']
            },
            {
                id: 'gradient',
                name: 'Gradiente',
                colors: ['#667eea', '#764ba2', '#667eea', '#5a67d8']
            },
            {
                id: 'minimal',
                name: 'Minimalista',
                colors: ['#FFFFFF', '#FFFFFF', '#2C3E50', '#1A252F']
            },
            {
                id: 'neon',
                name: 'Neon',
                colors: ['#0A0A0A', '#1A1A1A', '#00FF9D', '#00CC7A']
            }
        ];

        // Função para aplicar tema
        function applyTheme(themeId, color = null) {
            // Remover todas as classes de tema
            document.body.classList.remove('theme-light', 'theme-dark', 'theme-blue', 'theme-green', 'theme-purple', 'theme-orange', 'theme-pink', 'theme-gray', 'theme-teal', 'theme-indigo', 'theme-yellow', 'theme-brown', 'theme-cyan', 'theme-lime', 'theme-deep-orange', 'theme-deep-purple', 'theme-light-blue', 'theme-light-green', 'theme-amber', 'theme-gradient', 'theme-minimal', 'theme-neon');
            
            // Aplicar novo tema
            document.body.classList.add(`theme-${themeId}`);
            currentTheme = themeId;
            
            // Salvar no localStorage para visitantes
            localStorage.setItem('guaraestoque_theme', themeId);
            
            // Atualizar controles na interface admin
            if (auth.currentUser) {
                updateThemeControls(themeId);
            }
        }

        // Função para carregar tema salvo
        function loadSavedTheme() {
            const savedTheme = localStorage.getItem('guaraestoque_theme') || 'light';
            const savedDarkMode = localStorage.getItem('guaraestoque_darkmode') === 'true';
            
            applyTheme(savedTheme);
            
            // Aplicar modo escuro se necessário
            if (savedDarkMode && savedTheme !== 'dark') {
                document.body.classList.add('theme-dark');
            }
            
            // Atualizar controles na interface admin
            if (auth.currentUser) {
                updateThemeControls(savedTheme);
                darkMode.checked = savedDarkMode;
            }
        }

        // Função para atualizar controles de tema
        function updateThemeControls(themeId) {
            // Atualizar seleção de tema
            const themeOptions = document.querySelectorAll('.theme-option');
            themeOptions.forEach(option => {
                option.classList.remove('selected');
                if (option.dataset.theme === themeId) {
                    option.classList.add('selected');
                }
            });
            
            // Atualizar checkboxes
            darkMode.checked = document.body.classList.contains('theme-dark');
        }

        // Função para carregar temas na interface
        function loadThemesInterface() {
            // Limpar containers
            themeSelector.innerHTML = '';
            
            // Adicionar opções de tema
            availableThemes.forEach(theme => {
                const themeOption = document.createElement('div');
                themeOption.className = 'theme-option';
                themeOption.dataset.theme = theme.id;
                
                const colorsHtml = theme.colors.map(color => 
                    `<div class="theme-preview-color" style="background: ${color};"></div>`
                ).join('');
                
                themeOption.innerHTML = `
                    <div class="theme-preview-colors">
                        ${colorsHtml}
                    </div>
                    <div class="theme-option-name">${theme.name}</div>
                `;
                
                themeOption.addEventListener('click', () => {
                    applyTheme(theme.id);
                    
                    // Salvar configuração se admin
                    if (auth.currentUser) {
                        saveThemeToFirestore();
                    }
                });
                
                themeSelector.appendChild(themeOption);
            });
        }

        // Função para salvar tema no Firestore
        function saveThemeToFirestore() {
            if (!auth.currentUser) return;
            
            const themeData = {
                theme: currentTheme,
                darkMode: darkMode.checked,
                updatedAt: firebase.firestore.FieldValue.serverTimestamp()
            };
            
            db.collection('settings').doc('theme').set(themeData)
                .then(() => {
                    console.log('Tema salvo no Firestore');
                })
                .catch(error => {
                    console.error('Erro ao salvar tema:', error);
                });
        }

        // Função para carregar tema do Firestore
        function loadThemeFromFirestore() {
            db.collection('settings').doc('theme').get()
                .then(doc => {
                    if (doc.exists) {
                        const themeData = doc.data();
                        currentTheme = themeData.theme || 'light';
                        
                        // Aplicar tema
                        applyTheme(currentTheme);
                        
                        // Aplicar modo escuro se necessário
                        if (themeData.darkMode && currentTheme !== 'dark') {
                            document.body.classList.add('theme-dark');
                        }
                        
                        // Atualizar controles
                        if (auth.currentUser) {
                            updateThemeControls(currentTheme);
                            darkMode.checked = themeData.darkMode || false;
                        }
                    } else {
                        // Usar tema padrão
                        loadSavedTheme();
                    }
                })
                .catch(error => {
                    console.error('Erro ao carregar tema:', error);
                    loadSavedTheme();
                });
        }

        // Aplicar modo escuro
        darkMode.addEventListener('change', () => {
            if (darkMode.checked && !document.body.classList.contains('theme-dark')) {
                document.body.classList.add('theme-dark');
            } else if (!darkMode.checked && currentTheme !== 'dark') {
                document.body.classList.remove('theme-dark');
            }
            
            if (auth.currentUser) {
                saveThemeToFirestore();
            }
        });

        // Sidebar Functions
        function openSidebar() {
            sidebar.classList.add('active');
            sidebarOverlay.classList.add('active');
            document.body.classList.add('sidebar-open');
        }

        function closeSidebar() {
            sidebar.classList.remove('active');
            sidebarOverlay.classList.remove('active');
            document.body.classList.remove('sidebar-open');
        }

        // Toggle submenu de categorias
        function toggleCategoriesSubmenu() {
            isCategoriesSubmenuOpen = !isCategoriesSubmenuOpen;
            sidebarCategoriesSubmenu.classList.toggle('active');
            
            const toggleIcon = sidebarCategoriesToggle.querySelector('.sidebar-menu-toggle');
            if (isCategoriesSubmenuOpen) {
                toggleIcon.classList.add('rotated');
            } else {
                toggleIcon.classList.remove('rotated');
            }
        }

        // Sidebar Event Listeners
        sidebarToggle.addEventListener('click', () => {
            if (sidebar.classList.contains('active')) {
                closeSidebar();
            } else {
                openSidebar();
            }
        });
        sidebarOverlay.addEventListener('click', closeSidebar);

        // Toggle submenu de categorias
        sidebarCategoriesToggle.addEventListener('click', (e) => {
            e.preventDefault();
            toggleCategoriesSubmenu();
        });

        // Menu item click handlers
        sidebarMenuItems.forEach(item => {
            item.addEventListener('click', (e) => {
                e.preventDefault();
                
                // Remove active class from all items
                document.querySelectorAll('.sidebar-menu a').forEach(menuItem => {
                    menuItem.classList.remove('active');
                });
                
                // Add active class to clicked item
                item.classList.add('active');
                
                // Get section from data attribute
                const section = item.getAttribute('data-section');
                
                // Handle different sections
                switch(section) {
                    case 'inicio':
                        window.scrollTo({ top: 0, behavior: 'smooth' });
                        break;
                    case 'produtos':
                        const productsSection = document.querySelector('#products-section');
                        if (productsSection) {
                            productsSection.scrollIntoView({ behavior: 'smooth' });
                        }
                        break;
                    case 'contato':
                        const footer2 = document.querySelector('footer');
                        if (footer2) {
                            footer2.scrollIntoView({ behavior: 'smooth' });
                        }
                        break;
                    case 'login':
                        loginModal.style.display = 'flex';
                        break;
                    case 'logout':
                        auth.signOut();
                        break;
                }
                
                // Close sidebar after selection
                closeSidebar();
            });
        });

        // Botão "Ver Produtos" do hero
        viewProductsBtn.addEventListener('click', function(e) {
            e.preventDefault();
            const productsSection = document.getElementById('products-section');
            if (productsSection) {
                productsSection.scrollIntoView({ behavior: 'smooth' });
            }
        });

        // Close sidebar on escape key
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape' && sidebar.classList.contains('active')) {
                closeSidebar();
            }
        });
        
        // Event Listeners
        addProductBtn.addEventListener('click', () => {
            isEditingProduct = false;
            document.getElementById('product-modal-title').textContent = 'Adicionar Novo Produto';
            productFormSubmit.textContent = 'Adicionar Produto';
            editProductId.value = '';
            productForm.reset();
            imagePreviewContainer.innerHTML = '';
            selectedFiles = [];
            currentEditingProductImages = [];
            addProductModal.style.display = 'flex';
        });
        
        addCategoryBtn.addEventListener('click', () => {
            addCategoryModal.style.display = 'flex';
        });
        
        manageCategoriesBtn.addEventListener('click', () => {
            isManagingCategories = !isManagingCategories;
            categoriesManagement.style.display = isManagingCategories ? 'block' : 'none';
            
            if (isManagingCategories) {
                loadCategoriesManagement();
                manageCategoriesBtn.innerHTML = '<i class="fas fa-eye"></i> Ver Produtos';
            } else {
                manageCategoriesBtn.innerHTML = '<i class="fas fa-cog"></i> Gerenciar Categorias';
            }
        });
        
        adminSettingsBtn.addEventListener('click', () => {
            const isVisible = adminSettingsSection.style.display === 'block';
            adminSettingsSection.style.display = isVisible ? 'none' : 'block';
            
            if (!isVisible) {
                // Carregar configurações salvas
                loadSystemSettings();
                updateSystemStats();
                loadThemesInterface();
                updateThemeControls(currentTheme);
            }
        });
        
        closeModals.forEach(btn => {
            btn.addEventListener('click', () => {
                loginModal.style.display = 'none';
                addProductModal.style.display = 'none';
                addCategoryModal.style.display = 'none';
                quickStockModal.style.display = 'none';
            });
        });
        
        galleryClose.addEventListener('click', () => {
            galleryModal.style.display = 'none';
        });
        
        productModalClose.addEventListener('click', () => {
            productModal.style.display = 'none';
        });
        
        // WhatsApp button
        whatsappBtn.addEventListener('click', () => {
            const whatsappUrl = `https://wa.me/${whatsappSettings.number}`;
            window.open(whatsappUrl, '_blank');
        });
        
        // Controles de estoque rápido
        decreaseStockBtn.addEventListener('click', () => {
            const currentValue = parseInt(quickStockQuantity.value) || 0;
            if (currentValue > 0) {
                quickStockQuantity.value = currentValue - 1;
            }
        });
        
        increaseStockBtn.addEventListener('click', () => {
            const currentValue = parseInt(quickStockQuantity.value) || 0;
            quickStockQuantity.value = currentValue + 1;
        });
        
        // Salvar configurações do sistema
        saveSystemSettingsBtn.addEventListener('click', () => {
            saveSystemSettings();
        });
        
        // Restaurar configurações padrão
        resetSystemSettingsBtn.addEventListener('click', () => {
            if (confirm('Tem certeza que deseja restaurar todas as configurações para os valores padrão? Esta ação não pode ser desfeita.')) {
                resetSystemSettings();
            }
        });
        
        // Controles de exibição (itens por página)
        displayControls.forEach(btn => {
            btn.addEventListener('click', () => {
                displayControls.forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                itemsPerPage = parseInt(btn.getAttribute('data-items'));
                filterAndDisplayProducts();
            });
        });
        
        // Botão de exportação
        exportProductsBtn.addEventListener('click', () => {
            exportProductsToCSV();
        });
        
        // Botão de backup
        backupSystemBtn.addEventListener('click', () => {
            createSystemBackup();
        });
        
        // Função de busca
        searchButton.addEventListener('click', performSearch);
        searchInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                performSearch();
            }
        });
        
        function performSearch() {
            if (!enableSearch.checked) return;
            
            currentSearchQuery = searchInput.value.trim().toLowerCase();
            filterAndDisplayProducts();
        }
        
        function filterAndDisplayProducts() {
            loadingSpinner.style.display = 'block';
            productsGrid.innerHTML = '';
            productsGrid.appendChild(loadingSpinner);
            
            setTimeout(() => {
                let filteredProducts = allProducts;
                
                // Filtrar por categoria
                if (currentCategory !== 'all') {
                    filteredProducts = filteredProducts.filter(product => 
                        product.category === currentCategory
                    );
                }
                
                // Filtrar por busca
                if (currentSearchQuery) {
                    filteredProducts = filteredProducts.filter(product => 
                        product.title.toLowerCase().includes(currentSearchQuery) ||
                        product.description.toLowerCase().includes(currentSearchQuery) ||
                        (product.brand && product.brand.toLowerCase().includes(currentSearchQuery)) ||
                        product.category.toLowerCase().includes(currentSearchQuery)
                    );
                }
                
                // Embaralhar os produtos aleatoriamente
                filteredProducts = shuffleArray(filteredProducts);
                
                // Limitar por página
                const paginatedProducts = filteredProducts.slice(0, itemsPerPage);
                
                // Exibir produtos filtrados
                productsGrid.innerHTML = '';
                
                if (paginatedProducts.length === 0) {
                    productsGrid.innerHTML = `
                        <div class="search-empty">
                            <i class="fas fa-search"></i>
                            <h3>Nenhum produto encontrado</h3>
                            <p>${currentSearchQuery ? `Não encontramos resultados para "${currentSearchQuery}"` : 'Não há produtos nesta categoria.'}</p>
                            ${currentSearchQuery ? `<button id="clear-search" class="btn btn-primary" style="margin-top: 1rem;">Limpar busca</button>` : ''}
                        </div>
                    `;
                    
                    if (currentSearchQuery) {
                        document.getElementById('clear-search').addEventListener('click', () => {
                            searchInput.value = '';
                            currentSearchQuery = '';
                            filterAndDisplayProducts();
                        });
                    }
                } else {
                    paginatedProducts.forEach(product => {
                        displayProductCard(product.id, product, product.images);
                    });
                }
                
                loadingSpinner.style.display = 'none';
            }, 300);
        }
        
        window.addEventListener('click', (e) => {
            if (e.target === loginModal) {
                loginModal.style.display = 'none';
            }
            if (e.target === addProductModal) {
                addProductModal.style.display = 'none';
            }
            if (e.target === addCategoryModal) {
                addCategoryModal.style.display = 'none';
            }
            if (e.target === galleryModal) {
                galleryModal.style.display = 'none';
            }
            if (e.target === productModal) {
                productModal.style.display = 'none';
            }
            if (e.target === quickStockModal) {
                quickStockModal.style.display = 'none';
            }
        });
        
        // Preview das imagens selecionadas
        imageUpload.addEventListener('change', function(e) {
            const files = e.target.files;
            selectedFiles = Array.from(files);
            imagePreviewContainer.innerHTML = '';
            
            if (files.length > 0) {
                for (let i = 0; i < files.length; i++) {
                    const file = files[i];
                    const reader = new FileReader();
                    
                    reader.onload = function(event) {
                        const previewDiv = document.createElement('div');
                        previewDiv.className = 'image-preview';
                        previewDiv.innerHTML = `
                            <img src="${event.target.result}" alt="Preview">
                            <button type="button" class="remove-image" data-index="${i}">&times;</button>
                        `;
                        imagePreviewContainer.appendChild(previewDiv);
                    };
                    
                    reader.readAsDataURL(file);
                }
            }
        });
        
        // Remover imagem selecionada
        imagePreviewContainer.addEventListener('click', (e) => {
            if (e.target.classList.contains('remove-image')) {
                const index = parseInt(e.target.getAttribute('data-index'));
                selectedFiles.splice(index, 1);
                
                // Recriar a lista de visualização
                imagePreviewContainer.innerHTML = '';
                if (selectedFiles.length > 0) {
                    selectedFiles.forEach((file, i) => {
                        const reader = new FileReader();
                        reader.onload = function(event) {
                            const previewDiv = document.createElement('div');
                            previewDiv.className = 'image-preview';
                            previewDiv.innerHTML = `
                                <img src="${event.target.result}" alt="Preview">
                                <button type="button" class="remove-image" data-index="${i}">&times;</button>
                            `;
                            imagePreviewContainer.appendChild(previewDiv);
                        };
                        reader.readAsDataURL(file);
                    });
                }
            }
        });
        
        // Navegação da galeria
        galleryPrev.addEventListener('click', () => {
            if (currentGalleryImages.length > 0) {
                currentImageIndex = (currentImageIndex - 1 + currentGalleryImages.length) % currentGalleryImages.length;
                updateGalleryImage();
            }
        });
        
        galleryNext.addEventListener('click', () => {
            if (currentGalleryImages.length > 0) {
                currentImageIndex = (currentImageIndex + 1) % currentGalleryImages.length;
                updateGalleryImage();
            }
        });
        
        // Atualizar imagem principal da galeria
        function updateGalleryImage() {
            if (currentGalleryImages.length > 0) {
                galleryMainImage.src = currentGalleryImages[currentImageIndex];
                imageCount.textContent = `${currentImageIndex + 1} / ${currentGalleryImages.length}`;
                
                // Atualizar thumbnails ativos
                const thumbnails = galleryThumbnails.querySelectorAll('.gallery-thumbnail');
                thumbnails.forEach((thumb, index) => {
                    if (index === currentImageIndex) {
                        thumb.classList.add('active');
                    } else {
                        thumb.classList.remove('active');
                    }
                });
            }
        }
        
        // Atualizar thumbnails no modal de produto
        function updateProductModalThumbnails() {
            productModalThumbnails.innerHTML = '';
            
            currentProductModalImages.forEach((img, index) => {
                const thumbnail = document.createElement('div');
                thumbnail.className = `product-modal-thumbnail ${index === currentProductModalIndex ? 'active' : ''}`;
                thumbnail.innerHTML = `<img src="${img}" alt="Thumbnail ${index + 1}">`;
                thumbnail.addEventListener('click', () => {
                    currentProductModalIndex = index;
                    productModalMainImg.src = img;
                    updateProductModalThumbnails();
                });
                productModalThumbnails.appendChild(thumbnail);
            });
        }
        
        // Login form
        loginForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;
            
            auth.signInWithEmailAndPassword(email, password)
                .then((userCredential) => {
                    loginModal.style.display = 'none';
                    loginMessage.textContent = '';
                    loginForm.reset();
                    showToast('Login realizado com sucesso!');
                })
                .catch((error) => {
                    loginMessage.textContent = 'Erro no login: ' + error.message;
                });
        });
        
        // Product form
        productForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            
            // Get form values
            const title = document.getElementById('product-title').value;
            const price = document.getElementById('product-price').value;
            const oldPrice = document.getElementById('product-old-price').value;
            const category = document.getElementById('product-category').value;
            const description = document.getElementById('product-description').value;
            const stock = document.getElementById('product-stock').value;
            const brand = document.getElementById('product-brand').value;
            
            // Determine stock status
            let stockStatus = 'in-stock';
            if (stock <= 0) {
                stockStatus = 'out-of-stock';
            } else if (stock <= 5) {
                stockStatus = 'low-stock';
            }
            
            // Se estamos editando um produto existente
            if (isEditingProduct && currentEditingProductId) {
                productMessage.textContent = 'Atualizando produto...';
                productMessage.style.color = 'var(--text)';
                
                try {
                    // Preparar dados para atualização
                    const updateData = {
                        title,
                        price: parseFloat(price),
                        oldPrice: oldPrice ? parseFloat(oldPrice) : null,
                        category,
                        description,
                        stock: parseInt(stock),
                        stockStatus,
                        brand: brand || '',
                        updatedAt: firebase.firestore.FieldValue.serverTimestamp()
                    };
                    
                    // Se há novas imagens, fazer upload
                    if (selectedFiles.length > 0) {
                        const imageData = [];
                        for (const file of selectedFiles) {
                            const imageInfo = await uploadImageToImgBB(file);
                            imageData.push(imageInfo);
                        }
                        
                        updateData.imageUrls = [...currentEditingProductImages, ...imageData.map(img => img.url)];
                        updateData.imageDeleteHashes = updateData.imageDeleteHashes ? [...updateData.imageDeleteHashes, ...imageData.map(img => img.deleteHash)] : imageData.map(img => img.deleteHash);
                    }
                    
                    // Atualizar produto no Firestore
                    await db.collection('products').doc(currentEditingProductId).update(updateData);
                    
                    productMessage.textContent = 'Produto atualizado com sucesso!';
                    productMessage.style.color = 'var(--success)';
                    showToast('Produto atualizado com sucesso!');
                    
                    setTimeout(() => {
                        addProductModal.style.display = 'none';
                        productMessage.textContent = '';
                        productForm.reset();
                        imagePreviewContainer.innerHTML = '';
                        selectedFiles = [];
                        currentEditingProductImages = [];
                        loadProducts();
                    }, 1500);
                    
                } catch (error) {
                    productMessage.textContent = 'Erro ao atualizar produto: ' + error.message;
                    productMessage.style.color = 'var(--primary)';
                    console.error('Erro detalhado:', error);
                }
                
            } else {
                // Adicionar novo produto
                
                // Verificar se imagens foram selecionadas
                if (selectedFiles.length === 0) {
                    productMessage.textContent = 'Por favor, selecione pelo menos uma imagem.';
                    productMessage.style.color = 'var(--primary)';
                    return;
                }
                
                // Upload das imagens para o imgBB
                productMessage.textContent = 'Enviando imagens...';
                productMessage.style.color = 'var(--text)';
                
                try {
                    const imageData = [];
                    for (const file of selectedFiles) {
                        const imageInfo = await uploadImageToImgBB(file);
                        imageData.push(imageInfo);
                    }
                    
                    // Gerar um ID único para o produto
                    const productId = db.collection('products').doc().id;
                    
                    // Add product to Firestore
                    db.collection('products').doc(productId).set({
                        title,
                        price: parseFloat(price),
                        oldPrice: oldPrice ? parseFloat(oldPrice) : null,
                        category,
                        description,
                        stock: parseInt(stock),
                        stockStatus,
                        brand: brand || '',
                        imageUrls: imageData.map(img => img.url),
                        imageDeleteHashes: imageData.map(img => img.deleteHash),
                        productId: productId, // Salvar o ID como campo também
                        createdAt: firebase.firestore.FieldValue.serverTimestamp()
                    })
                    .then(() => {
                        productMessage.textContent = 'Produto adicionado com sucesso!';
                        productMessage.style.color = 'var(--success)';
                        productForm.reset();
                        imagePreviewContainer.innerHTML = '';
                        selectedFiles = [];
                        showToast('Produto adicionado com sucesso!');
                        setTimeout(() => {
                            addProductModal.style.display = 'none';
                            productMessage.textContent = '';
                            loadProducts();
                        }, 1500);
                    })
                    .catch((error) => {
                        productMessage.textContent = 'Erro ao adicionar produto: ' + error.message;
                        productMessage.style.color = 'var(--primary)';
                        console.error('Erro detalhado:', error);
                    });
                    
                } catch (error) {
                    productMessage.textContent = 'Erro no upload das imagens: ' + error.message;
                    productMessage.style.color = 'var(--primary)';
                }
            }
        });
        
        // Formulário de categoria
        categoryForm.addEventListener('submit', (e) => {
            e.preventDefault();
            
            const categoryName = document.getElementById('category-name').value.trim();
            const categoryEmoji = document.getElementById('category-emoji').value.trim();
            
            if (!categoryEmoji) {
                categoryMessage.textContent = 'Por favor, digite um emoji para a categoria.';
                categoryMessage.style.color = 'var(--primary)';
                return;
            }
            
            // Verificar se categoria já existe
            const categoryExists = allCategories.some(cat => 
                cat.name.toLowerCase() === categoryName.toLowerCase()
            );
            
            if (categoryExists) {
                categoryMessage.textContent = 'Esta categoria já existe.';
                categoryMessage.style.color = 'var(--primary)';
                return;
            }
            
            // Adicionar categoria
            db.collection('categories').add({
                name: categoryName,
                emoji: categoryEmoji,
                createdAt: firebase.firestore.FieldValue.serverTimestamp()
            })
            .then(() => {
                categoryMessage.textContent = 'Categoria criada com sucesso!';
                categoryMessage.style.color = 'var(--success)';
                categoryForm.reset();
                showToast('Categoria criada com sucesso!');
                setTimeout(() => {
                    addCategoryModal.style.display = 'none';
                    categoryMessage.textContent = '';
                    loadCategories();
                }, 1500);
            })
            .catch((error) => {
                categoryMessage.textContent = 'Erro ao criar categoria: ' + error.message;
                categoryMessage.style.color = 'var(--primary)';
            });
        });
        
        // Formulário de estoque rápido
        quickStockForm.addEventListener('submit', (e) => {
            e.preventDefault();
            
            const productId = quickStockProductId.value;
            const newStock = parseInt(quickStockQuantity.value);
            
            if (isNaN(newStock) || newStock < 0) {
                showToast('Quantidade inválida', 'error');
                return;
            }
            
            // Determine stock status
            let stockStatus = 'in-stock';
            if (newStock <= 0) {
                stockStatus = 'out-of-stock';
            } else if (newStock <= 5) {
                stockStatus = 'low-stock';
            }
            
            db.collection('products').doc(productId).update({
                stock: newStock,
                stockStatus: stockStatus,
                updatedAt: firebase.firestore.FieldValue.serverTimestamp()
            })
            .then(() => {
                showToast('Estoque atualizado com sucesso!');
                quickStockModal.style.display = 'none';
                loadProducts();
            })
            .catch((error) => {
                showToast('Erro ao atualizar estoque: ' + error.message, 'error');
            });
        });
        
        // Função para fazer upload da imagem para o imgBB
        async function uploadImageToImgBB(imageFile) {
            const formData = new FormData();
            formData.append('image', imageFile);
            
            const response = await fetch(`https://api.imgbb.com/1/upload?key=${IMGBB_API_KEY}`, {
                method: 'POST',
                body: formData
            });
            
            const data = await response.json();
            
            if (data.success) {
                let deleteHash = null;
                if (data.data.delete_url) {
                    const urlParts = data.data.delete_url.split('/');
                    deleteHash = urlParts[urlParts.length - 1];
                }
                
                return {
                    url: data.data.url,
                    deleteHash: deleteHash
                };
            } else {
                throw new Error(data.error.message || 'Falha no upload da imagem');
            }
        }
        
        // Função para deletar imagem do ImgBB
        async function deleteImageFromImgBB(deleteHash) {
            if (!deleteHash) {
                console.error('Nenhum delete hash fornecido');
                return false;
            }
            
            try {
                const response = await fetch(`https://api.imgbb.com/1/delete/${deleteHash}?key=${IMGBB_API_KEY}`, {
                    method: 'DELETE'
                });
                
                const data = await response.json();
                
                if (data.success) {
                    console.log('Imagem deletada com sucesso do ImgBB:', deleteHash);
                    return true;
                } else {
                    console.error('Falha ao deletar imagem do ImgBB:', data.error);
                    return false;
                }
            } catch (error) {
                console.error('Erro ao deletar imagem do ImgBB:', error);
                return false;
            }
        }
        
        // Função para deletar categoria
        async function deleteCategory(categoryId) {
            if (!confirm('Tem certeza que deseja excluir esta categoria? Os produtos desta categoria permanecerão, mas ficarão sem categoria associada.')) {
                return;
            }
            
            try {
                await db.collection('categories').doc(categoryId).delete();
                showToast('Categoria excluída com sucesso!');
                loadCategories();
                if (isManagingCategories) {
                    loadCategoriesManagement();
                }
            } catch (error) {
                console.error('Erro ao excluir categoria:', error);
                showToast('Erro ao excluir categoria: ' + error.message, 'error');
            }
        }
        
        // Função para abrir modal de edição de produto
        function openEditProductModal(product) {
            isEditingProduct = true;
            currentEditingProductId = product.id;
            currentEditingProductImages = product.images || [];
            
            document.getElementById('product-modal-title').textContent = 'Editar Produto';
            productFormSubmit.textContent = 'Atualizar Produto';
            editProductId.value = product.id;
            
            // Preencher formulário com dados do produto
            document.getElementById('product-title').value = product.title;
            document.getElementById('product-price').value = product.price;
            document.getElementById('product-old-price').value = product.oldPrice || '';
            document.getElementById('product-category').value = product.category;
            document.getElementById('product-description').value = product.description;
            document.getElementById('product-stock').value = product.stock;
            document.getElementById('product-brand').value = product.brand || '';
            
            // Mostrar imagens existentes
            imagePreviewContainer.innerHTML = '';
            if (product.images && product.images.length > 0) {
                product.images.forEach((img, index) => {
                    const previewDiv = document.createElement('div');
                    previewDiv.className = 'image-preview';
                    previewDiv.innerHTML = `
                        <img src="${img}" alt="Preview ${index + 1}">
                        <button type="button" class="remove-image" data-index="${index}" data-existing="true">&times;</button>
                    `;
                    imagePreviewContainer.appendChild(previewDiv);
                });
            }
            
            addProductModal.style.display = 'flex';
        }
        
        // Função para abrir modal de estoque rápido
        function openQuickStockModal(product) {
            quickStockProductName.textContent = `Atualizar estoque de: ${product.title}`;
            quickStockQuantity.value = product.stock;
            quickStockProductId.value = product.id;
            quickStockModal.style.display = 'flex';
        }
        
        // Função para gerar link único do produto
        function generateProductLink(productId) {
            const baseUrl = window.location.origin + window.location.pathname;
            return `${baseUrl}?product=${productId}`;
        }
        
        // Função para criar botões de compartilhamento
        function createShareButtons(product) {
            shareButtonsContainer.innerHTML = '';
            const productLink = generateProductLink(product.id);
            const productTitle = encodeURIComponent(product.title);
            const productDescription = encodeURIComponent(product.description.substring(0, 100) + '...');
            
            // WhatsApp
            const whatsappBtn = document.createElement('a');
            whatsappBtn.className = 'share-btn whatsapp-share';
            whatsappBtn.href = `https://wa.me/?text=${encodeURIComponent(`Confira este produto: ${product.title} - ${productLink}`)}`;
            whatsappBtn.target = '_blank';
            whatsappBtn.innerHTML = '<i class="fab fa-whatsapp"></i> WhatsApp';
            shareButtonsContainer.appendChild(whatsappBtn);
            
            // Facebook
            const facebookBtn = document.createElement('a');
            facebookBtn.className = 'share-btn facebook-share';
            facebookBtn.href = `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(productLink)}&quote=${productTitle}`;
            facebookBtn.target = '_blank';
            facebookBtn.innerHTML = '<i class="fab fa-facebook-f"></i> Facebook';
            shareButtonsContainer.appendChild(facebookBtn);
            
            // Instagram (link para app ou web)
            const instagramBtn = document.createElement('a');
            instagramBtn.className = 'share-btn instagram-share';
            instagramBtn.href = `https://www.instagram.com/?url=${encodeURIComponent(productLink)}`;
            instagramBtn.target = '_blank';
            instagramBtn.innerHTML = '<i class="fab fa-instagram"></i> Instagram';
            shareButtonsContainer.appendChild(instagramBtn);
            
            // Copiar link
            const copyLinkBtn = document.createElement('a');
            copyLinkBtn.className = 'share-btn copy-link-share';
            copyLinkBtn.href = '#';
            copyLinkBtn.innerHTML = '<i class="fas fa-copy"></i> Copiar Link';
            copyLinkBtn.addEventListener('click', (e) => {
                e.preventDefault();
                copyToClipboard(productLink);
            });
            shareButtonsContainer.appendChild(copyLinkBtn);
        }
        
        // Função para copiar link para a área de transferência
        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(() => {
                showToast('Link copiado para a área de transferência!');
            }).catch(err => {
                console.error('Erro ao copiar: ', err);
                showToast('Erro ao copiar link', 'error');
            });
        }
        
        // Verificar se há um parâmetro de produto na URL
        function checkUrlForProduct() {
            const urlParams = new URLSearchParams(window.location.search);
            const productId = urlParams.get('product');
            
            if (productId) {
                // Buscar produto pelo ID
                db.collection('products').doc(productId).get()
                    .then(doc => {
                        if (doc.exists) {
                            const product = doc.data();
                            openProductModal({
                                id: productId,
                                ...product,
                                images: product.imageUrls || []
                            });
                        }
                    })
                    .catch(error => {
                        console.error('Erro ao buscar produto:', error);
                    });
            }
        }
        
        // Função para criar exibição de preços com desconto (preço antigo acima do atual)
        function createPriceDisplay(product) {
            const priceContainer = document.createElement('div');
            priceContainer.className = 'price-old-above';
            
            if (product.oldPrice && product.oldPrice > product.price) {
                // Calcular porcentagem de desconto
                const discountPercent = calculateDiscountPercentage(product.oldPrice, product.price);
                
                // Preço original riscado acima (vermelho)
                const oldPriceSpan = document.createElement('span');
                oldPriceSpan.className = 'old-price';
                oldPriceSpan.textContent = `De: R$ ${product.oldPrice.toLocaleString('pt-BR', {minimumFractionDigits: 2})}`;
                priceContainer.appendChild(oldPriceSpan);
                
                // Preço atual em preto (maior)
                const priceSpan = document.createElement('span');
                priceSpan.className = 'current-price';
                priceSpan.textContent = `Por: R$ ${product.price.toLocaleString('pt-BR', {minimumFractionDigits: 2})}`;
                priceContainer.appendChild(priceSpan);
                
                // Badge de desconto VERDE
                const discountBadge = document.createElement('span');
                discountBadge.className = 'discount-percentage';
                discountBadge.textContent = `${discountPercent}% OFF`;
                discountBadge.style.marginTop = '5px';
                discountBadge.style.display = 'inline-block';
                priceContainer.appendChild(discountBadge);
                
                // Texto de economia
                const savings = product.oldPrice - product.price;
                const savingsSpan = document.createElement('span');
                savingsSpan.style.color = 'var(--success)';
                savingsSpan.style.fontSize = '0.9rem';
                savingsSpan.style.marginTop = '3px';
                savingsSpan.textContent = `Economize R$ ${savings.toLocaleString('pt-BR', {minimumFractionDigits: 2})}`;
                priceContainer.appendChild(savingsSpan);
            } else {
                // Apenas preço atual em preto
                const priceSpan = document.createElement('span');
                priceSpan.className = 'current-price';
                priceSpan.textContent = `R$ ${product.price.toLocaleString('pt-BR', {minimumFractionDigits: 2})}`;
                priceContainer.appendChild(priceSpan);
            }
            
            return priceContainer;
        }
        
        // Função para abrir modal de produto expandido
        function openProductModal(product) {
            currentProductForSharing = product;
            
            // Definir imagens
            currentProductModalImages = product.images;
            currentProductModalIndex = 0;
            
            // Atualizar imagem principal
            productModalMainImg.src = product.images[0];
            
            // Atualizar thumbnails
            updateProductModalThumbnails();
            
            // Atualizar informações do produto
            productModalTitleElem.textContent = product.title;
            
            // Atualizar preços (com preço antigo acima)
            productModalPriceContainer.innerHTML = '';
            productModalPriceContainer.appendChild(createPriceDisplay(product));
            
            // Determinar texto do status do estoque
            let stockText = '';
            let stockClass = '';
            switch(product.stockStatus) {
                case 'in-stock':
                    stockText = `Em estoque (${product.stock} unidades)`;
                    stockClass = 'in-stock';
                    break;
                case 'low-stock':
                    stockText = `Estoque baixo (${product.stock} unidades)`;
                    stockClass = 'low-stock';
                    break;
                case 'out-of-stock':
                    stockText = 'Fora de estoque';
                    stockClass = 'out-of-stock';
                    break;
                default:
                    if (product.stock > 5) {
                        stockText = `Em estoque (${product.stock} unidades)`;
                        stockClass = 'in-stock';
                    } else if (product.stock > 0) {
                        stockText = `Estoque baixo (${product.stock} unidades)`;
                        stockClass = 'low-stock';
                    } else {
                        stockText = 'Fora de estoque';
                        stockClass = 'out-of-stock';
                    }
            }
            
            productModalStock.textContent = stockText;
            productModalStock.className = `product-modal-stock ${stockClass}`;
            
            // Atualizar descrição
            productModalDescription.textContent = product.description;
            
            // Atualizar features
            productModalFeatures.innerHTML = '';
            
            // Encontrar emoji da categoria
            let categoryEmoji = '🏷️';
            const categoryData = allCategories.find(cat => cat.name === product.category);
            if (categoryData && categoryData.emoji) {
                categoryEmoji = categoryData.emoji;
            }
            
            // Adicionar categoria
            const categoryFeature = document.createElement('div');
            categoryFeature.className = 'product-modal-feature';
            categoryFeature.innerHTML = `${categoryEmoji} ${product.category}`;
            productModalFeatures.appendChild(categoryFeature);
            
            // Adicionar marca se existir
            if (product.brand) {
                const brandFeature = document.createElement('div');
                brandFeature.className = 'product-modal-feature';
                brandFeature.innerHTML = `<i class="fas fa-industry"></i> ${product.brand}`;
                productModalFeatures.appendChild(brandFeature);
            }
            
            // Atualizar ações
            productModalActions.innerHTML = '';
            
            // Botão para ver imagens
            const viewImagesBtn = document.createElement('button');
            viewImagesBtn.className = 'product-modal-action-btn product-modal-view-images';
            viewImagesBtn.innerHTML = '<i class="fas fa-images"></i> Ver Imagens';
            viewImagesBtn.addEventListener('click', () => {
                productModal.style.display = 'none';
                openGallery(product.images);
            });
            productModalActions.appendChild(viewImagesBtn);
            
            // Botão "COMPRAR AGORA" (antigo "Entrar em Contato")
            const contactBtn = document.createElement('button');
            contactBtn.className = 'product-modal-action-btn product-modal-contact';
            contactBtn.innerHTML = '<i class="fab fa-whatsapp"></i> Comprar Agora';
            contactBtn.addEventListener('click', () => {
                // Mensagem fixa: "Esse item está disponível?" seguida do link do produto
                const productLink = generateProductLink(product.id);
                const message = `Esse item está disponível? ${productLink}`;
                const whatsappUrl = `https://wa.me/${whatsappSettings.number}?text=${encodeURIComponent(message)}`;
                window.open(whatsappUrl, '_blank');
            });
            productModalActions.appendChild(contactBtn);
            
            // Criar botões de compartilhamento
            createShareButtons(product);
            
            // Botões de administração (apenas para admin logado)
            if (auth.currentUser && product.id) {
                // Botão para editar produto
                const editBtn = document.createElement('button');
                editBtn.className = 'product-modal-action-btn product-modal-edit';
                editBtn.innerHTML = '<i class="fas fa-edit"></i> Editar Produto';
                editBtn.addEventListener('click', () => {
                    productModal.style.display = 'none';
                    openEditProductModal(product);
                });
                productModalActions.appendChild(editBtn);
                
                // Botão para atualizar estoque rapidamente
                const updateStockBtn = document.createElement('button');
                updateStockBtn.className = 'product-modal-action-btn product-modal-update-stock';
                updateStockBtn.innerHTML = '<i class="fas fa-boxes"></i> Atualizar Estoque';
                updateStockBtn.addEventListener('click', () => {
                    productModal.style.display = 'none';
                    openQuickStockModal(product);
                });
                productModalActions.appendChild(updateStockBtn);
                
                // Botão para deletar produto
                const deleteBtn = document.createElement('button');
                deleteBtn.className = 'product-modal-action-btn product-modal-delete';
                deleteBtn.innerHTML = '<i class="fas fa-trash"></i> Excluir Produto';
                deleteBtn.addEventListener('click', async () => {
                    if (confirm('Tem certeza que deseja excluir este produto? Esta ação não pode ser desfeita.')) {
                        try {
                            deleteBtn.disabled = true;
                            deleteBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Excluindo...';
                            
                            // Primeiro, buscar os delete hashes das imagens
                            const productDoc = await db.collection('products').doc(product.id).get();
                            const productData = productDoc.data();
                            const imageDeleteHashes = productData.imageDeleteHashes || [];
                            
                            // Deletar imagens do ImgBB
                            if (imageDeleteHashes.length > 0) {
                                console.log(`Deletando ${imageDeleteHashes.length} imagens do ImgBB...`);
                                const deletePromises = imageDeleteHashes.map(hash => deleteImageFromImgBB(hash));
                                await Promise.allSettled(deletePromises);
                            }
                            
                            // Deletar documento do Firestore
                            await db.collection('products').doc(product.id).delete();
                            
                            showToast('Produto excluído com sucesso!');
                            productModal.style.display = 'none';
                            loadProducts();
                        } catch (error) {
                            console.error('Erro ao excluir produto:', error);
                            showToast('Erro ao excluir produto: ' + error.message, 'error');
                            deleteBtn.disabled = false;
                            deleteBtn.innerHTML = '<i class="fas fa-trash"></i> Excluir Produto';
                        }
                    }
                });
                productModalActions.appendChild(deleteBtn);
            }
            
            // Mostrar modal
            productModal.style.display = 'flex';
        }
        
        // Abrir galeria de imagens
        function openGallery(images) {
            currentGalleryImages = images;
            currentImageIndex = 0;
            
            // Atualizar a galeria
            galleryThumbnails.innerHTML = '';
            images.forEach((img, index) => {
                const thumb = document.createElement('div');
                thumb.className = 'gallery-thumbnail';
                if (index === 0) thumb.classList.add('active');
                thumb.innerHTML = `<img src="${img}" alt="Thumbnail ${index + 1}">`;
                thumb.addEventListener('click', () => {
                    currentImageIndex = index;
                    updateGalleryImage();
                });
                galleryThumbnails.appendChild(thumb);
            });
            
            updateGalleryImage();
            galleryModal.style.display = 'flex';
        }
        
        // Função para reinicializar o Firebase com novas configurações
        function reinitializeFirebase(newConfig) {
            try {
                // Se já existe um app Firebase, deletar antes de reinicializar
                if (firebase.apps.length > 0) {
                    firebase.app().delete();
                }
                
                // Inicializar com novas configurações
                firebase.initializeApp(newConfig);
                console.log("Firebase reinicializado com sucesso!");
                
                // Atualizar referências
                auth = firebase.auth();
                db = firebase.firestore();
                
                return true;
            } catch (error) {
                console.error("Erro ao reinicializar Firebase:", error);
                return false;
            }
        }
        
        // Carregar configurações do sistema
        function loadSystemSettings() {
            db.collection('settings').doc('system').get()
                .then(doc => {
                    if (doc.exists) {
                        const data = doc.data();
                        systemSettings = data;
                        
                        // Configurações gerais
                        systemNameInput.value = data.name || 'Guara Estoque';
                        systemSloganInput.value = data.slogan || 'A melhor opção de Guarapari';
                        systemDescriptionInput.value = data.description || 'Sistema completo de controle de inventário e gestão de produtos para sua empresa.';
                        systemCurrencyInput.value = data.currency || 'R$';
                        systemTimezoneInput.value = data.timezone || 'America/Sao_Paulo';
                        
                        // Configurações de contato
                        contactEmailInput.value = data.contactEmail || 'contato@guaraestoque.com';
                        contactPhoneInput.value = data.contactPhone || '(27) 99631-6212';
                        contactAddressInput.value = data.contactAddress || 'Av. Comercial, 1234, Centro, Guarapari-ES';
                        whatsappNumber.value = data.whatsappNumber || '5527996316212';
                        whatsappMessageInput.value = data.whatsappMessage || 'Olá! Vi seu produto no Guara Estoque e gostaria de mais informações.';
                        whatsappSettings.number = data.whatsappNumber || '5527996316212';
                        
                        // Configurações de API
                        firebaseApiKeyInput.value = data.firebaseApiKey || firebaseConfig.apiKey;
                        firebaseAuthDomainInput.value = data.firebaseAuthDomain || firebaseConfig.authDomain;
                        firebaseProjectIdInput.value = data.firebaseProjectId || firebaseConfig.projectId;
                        firebaseStorageBucketInput.value = data.firebaseStorageBucket || firebaseConfig.storageBucket;
                        firebaseMessagingSenderIdInput.value = data.firebaseMessagingSenderId || firebaseConfig.messagingSenderId;
                        firebaseAppIdInput.value = data.firebaseAppId || firebaseConfig.appId;
                        imgbbApiKeyInput.value = data.imgbbApiKey || IMGBB_API_KEY;
                        
                        // Configurações de exibição
                        showStockStatus.checked = data.showStockStatus !== false;
                        showProductFeatures.checked = data.showProductFeatures !== false;
                        showCategoriesSidebar.checked = data.showCategoriesSidebar !== false;
                        enableSearch.checked = data.enableSearch !== false;
                        
                        // Configurações de tema já são carregadas separadamente
                        
                        // Backup e exportação
                        backupFrequency.value = data.backupFrequency || 'weekly';
                        
                        // Última atualização
                        if (data.updatedAt) {
                            const lastUpdate = data.updatedAt.toDate ? data.updatedAt.toDate() : new Date(data.updatedAt);
                            updateLastUpdateDisplay(lastUpdate);
                        }
                        
                        // Atualizar footer
                        updateFooter();
                        
                        // Atualizar título da página
                        document.querySelector('.logo span').textContent = systemNameInput.value;
                        document.title = systemNameInput.value + ' - Controle de Inventário';
                    }
                })
                .catch(error => {
                    console.error('Erro ao carregar configurações do sistema:', error);
                });
        }
        
        // Atualizar exibição da última atualização
        function updateLastUpdateDisplay(date) {
            if (!date) return;
            
            const now = new Date();
            const diffMs = now - date;
            const diffHours = Math.floor(diffMs / (1000 * 60 * 60));
            
            let timeText = '';
            if (diffHours < 1) {
                timeText = 'há menos de 1 hora';
            } else if (diffHours === 1) {
                timeText = 'há 1 hora';
            } else if (diffHours < 24) {
                timeText = `há ${diffHours} horas`;
            } else if (diffHours < 48) {
                timeText = 'ontem';
            } else {
                timeText = date.toLocaleDateString('pt-BR');
            }
            
            statLastUpdate.textContent = timeText;
            statLastUpdateDetail.textContent = `Data: ${date.toLocaleDateString('pt-BR')} às ${date.toLocaleTimeString('pt-BR', { hour: '2-digit', minute: '2-digit' })}`;
            lastUpdateData.timestamp = date;
        }
        
        // Salvar configurações do sistema
        function saveSystemSettings() {
            const settings = {
                // Configurações gerais
                name: systemNameInput.value,
                slogan: systemSloganInput.value,
                description: systemDescriptionInput.value,
                currency: systemCurrencyInput.value,
                timezone: systemTimezoneInput.value,
                
                // Configurações de contato
                contactEmail: contactEmailInput.value,
                contactPhone: contactPhoneInput.value,
                contactAddress: contactAddressInput.value,
                whatsappNumber: whatsappNumber.value,
                whatsappMessage: whatsappMessageInput.value,
                
                // Configurações de API
                firebaseApiKey: firebaseApiKeyInput.value,
                firebaseAuthDomain: firebaseAuthDomainInput.value,
                firebaseProjectId: firebaseProjectIdInput.value,
                firebaseStorageBucket: firebaseStorageBucketInput.value,
                firebaseMessagingSenderId: firebaseMessagingSenderIdInput.value,
                firebaseAppId: firebaseAppIdInput.value,
                imgbbApiKey: imgbbApiKeyInput.value,
                
                // Configurações de exibição
                showStockStatus: showStockStatus.checked,
                showProductFeatures: showProductFeatures.checked,
                showCategoriesSidebar: showCategoriesSidebar.checked,
                enableSearch: enableSearch.checked,
                itemsPerPage: itemsPerPage,
                
                // Configurações de tema são salvas separadamente
                
                // Backup e exportação
                backupFrequency: backupFrequency.value,
                
                updatedAt: firebase.firestore.FieldValue.serverTimestamp()
            };
            
            // Salvar no Firestore
            if (auth.currentUser) {
                db.collection('settings').doc('system').set(settings)
                .then(() => {
                    systemSettings = settings;
                    whatsappSettings.number = settings.whatsappNumber;
                    
                    // Atualizar configurações do Firebase e ImgBB globalmente
                    const newFirebaseConfig = {
                        apiKey: settings.firebaseApiKey,
                        authDomain: settings.firebaseAuthDomain,
                        projectId: settings.firebaseProjectId,
                        storageBucket: settings.firebaseStorageBucket,
                        messagingSenderId: settings.firebaseMessagingSenderId,
                        appId: settings.firebaseAppId
                    };
                    
                    // Atualizar variáveis globais
                    firebaseConfig = newFirebaseConfig;
                    IMGBB_API_KEY = settings.imgbbApiKey;
                    
                    // Tentar reinicializar o Firebase
                    const reinitialized = reinitializeFirebase(newFirebaseConfig);
                    
                    // Atualizar última atualização
                    const now = new Date();
                    updateLastUpdateDisplay(now);
                    
                    // Atualizar footer
                    updateFooter();
                    
                    // Atualizar título da página
                    document.querySelector('.logo span').textContent = settings.name;
                    document.title = settings.name + ' - Controle de Inventário';
                    
                    if (reinitialized) {
                        showToast('Configurações do sistema salvas com sucesso! Firebase reinicializado.');
                    } else {
                        showToast('Configurações do sistema salvas, mas houve um problema com o Firebase.');
                    }
                })
                .catch(error => {
                    console.error('Erro ao salvar configurações:', error);
                    showToast('Erro ao salvar configurações', 'error');
                });
            }
        }
        
        // Restaurar configurações padrão
        function resetSystemSettings() {
            if (confirm('Tem certeza que deseja restaurar todas as configurações para os valores padrão? Esta ação não pode ser desfeita.')) {
                // Configurações gerais
                systemNameInput.value = 'Guara Estoque';
                systemSloganInput.value = 'A melhor opção de Guarapari';
                systemDescriptionInput.value = 'Sistema completo de controle de inventário e gestão de produtos para sua empresa.';
                systemCurrencyInput.value = 'R$';
                systemTimezoneInput.value = 'America/Sao_Paulo';
                
                // Configurações de contato
                contactEmailInput.value = 'contato@guaraestoque.com';
                contactPhoneInput.value = '(27) 99631-6212';
                contactAddressInput.value = 'Av. Comercial, 1234, Centro, Guarapari-ES';
                whatsappNumber.value = '5527996316212';
                whatsappMessageInput.value = 'Olá! Vi seu produto no Guara Estoque e gostaria de mais informações.';
                
                // Configurações de API
                firebaseApiKeyInput.value = 'AIzaSyBP1YYeAluvIJMwwlB3rtKbVUUbx1riqUc';
                firebaseAuthDomainInput.value = 'corretora777.firebaseapp.com';
                firebaseProjectIdInput.value = 'corretora777';
                firebaseStorageBucketInput.value = 'corretora777.appspot.com';
                firebaseMessagingSenderIdInput.value = '217992558412';
                firebaseAppIdInput.value = '1:217992558412:web:your-app-id-here';
                imgbbApiKeyInput.value = 'f08cc6805510ac32c5ecdb6f5ed51689';
                
                // Configurações de exibição
                showStockStatus.checked = true;
                showProductFeatures.checked = true;
                showCategoriesSidebar.checked = true;
                enableSearch.checked = true;
                
                // Configurações de tema - restaurar para padrão
                applyTheme('light');
                loadThemesInterface();
                updateThemeControls('light');
                darkMode.checked = false;
                
                // Backup e exportação
                backupFrequency.value = 'weekly';
                
                // Atualizar display controls
                displayControls.forEach(btn => {
                    btn.classList.remove('active');
                    if (btn.getAttribute('data-items') === '12') {
                        btn.classList.add('active');
                        itemsPerPage = 12;
                    }
                });
                
                showToast('Configurações restauradas para os valores padrão.');
            }
        }
        
        // Atualizar estatísticas do sistema
        function updateSystemStats() {
            statProducts.textContent = allProducts.length;
            statCategories.textContent = allCategories.length;
            
            // Atualizar última atualização se já foi salva
            if (lastUpdateData.timestamp) {
                updateLastUpdateDisplay(lastUpdateData.timestamp);
            }
        }
        
        // Exportar produtos para CSV
        function exportProductsToCSV() {
            if (allProducts.length === 0) {
                showToast('Não há produtos para exportar.', 'error');
                return;
            }
            
            // Criar cabeçalho CSV
            let csv = 'Nome,Descrição,Categoria,Marca,Preço,Preço Original,Estoque,Status\n';
            
            // Adicionar dados dos produtos
            allProducts.forEach(product => {
                const row = [
                    `"${product.title.replace(/"/g, '""')}"`,
                    `"${product.description.replace(/"/g, '""')}"`,
                    `"${product.category || ''}"`,
                    `"${product.brand || ''}"`,
                    product.price,
                    product.oldPrice || '',
                    product.stock,
                    product.stockStatus
                ];
                csv += row.join(',') + '\n';
            });
            
            // Criar arquivo CSV
            const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `produtos_guaraestoque_${new Date().toISOString().split('T')[0]}.csv`;
            link.click();
            
            URL.revokeObjectURL(url);
            showToast('Produtos exportados com sucesso para CSV!');
        }
        
        // Criar backup do sistema
        function createSystemBackup() {
            const backupData = {
                products: allProducts,
                categories: allCategories,
                settings: systemSettings,
                theme: {
                    theme: currentTheme,
                    darkMode: darkMode.checked
                },
                timestamp: new Date().toISOString()
            };
            
            const backupJson = JSON.stringify(backupData, null, 2);
            const blob = new Blob([backupJson], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `backup_guaraestoque_${new Date().toISOString().split('T')[0]}.json`;
            link.click();
            
            URL.revokeObjectURL(url);
            showToast('Backup do sistema criado com sucesso!');
        }
        
        // Atualizar footer com as configurações
        function updateFooter() {
            footerSystemName.textContent = systemNameInput.value;
            footerSystemDescription.textContent = systemDescriptionInput.value;
            footerAddress.textContent = contactAddressInput.value;
            footerPhone.textContent = contactPhoneInput.value;
            footerEmail.textContent = contactEmailInput.value;
            footerCopyright.textContent = systemNameInput.value;
        }
        
        logoutBtn.addEventListener('click', () => {
            auth.signOut();
            showToast('Logout realizado com sucesso!');
        });
        
        // Auth state observer
        auth.onAuthStateChanged((user) => {
            if (user) {
                // User is signed in
                adminControls.style.display = 'flex';
                // Change sidebar login button to logout
                sidebarLoginLink.innerHTML = '<i class="fas fa-sign-out-alt"></i><span>Logout</span>';
                sidebarLoginLink.setAttribute('data-section', 'logout');
                // Carregar configurações do sistema
                loadSystemSettings();
                updateSystemStats();
                // Carregar temas na interface
                loadThemesInterface();
            } else {
                // User is signed out
                adminControls.style.display = 'none';
                adminSettingsSection.style.display = 'none';
                categoriesManagement.style.display = 'none';
                isManagingCategories = false;
                // Change sidebar button back to login
                sidebarLoginLink.innerHTML = '<i class="fas fa-sign-in-alt"></i><span>Login</span>';
                sidebarLoginLink.setAttribute('data-section', 'login');
            }
            // Reload products to show/hide admin buttons
            loadProducts();
            loadCategories();
        });
        
        // Carregar categorias do Firestore
        function loadCategories() {
            db.collection('categories').orderBy('name').get()
                .then((querySnapshot) => {
                    allCategories = [];
                    sidebarCategoriesSubmenu.innerHTML = '';
                    productCategorySelect.innerHTML = '<option value="">Selecione uma categoria</option>';
                    
                    // Adicionar item "Todos os Produtos" no submenu
                    const allItem = document.createElement('li');
                    const allLink = document.createElement('a');
                    allLink.href = '#';
                    allLink.setAttribute('data-category', 'all');
                    allLink.innerHTML = '<i class="fas fa-th-large"></i><span>Todos os Produtos</span>';
                    allLink.addEventListener('click', (e) => {
                        e.preventDefault();
                        currentCategory = 'all';
                        currentSearchQuery = '';
                        searchInput.value = '';
                        filterAndDisplayProducts();
                        closeSidebar();
                    });
                    allItem.appendChild(allLink);
                    sidebarCategoriesSubmenu.appendChild(allItem);
                    
                    if (!querySnapshot.empty) {
                        querySnapshot.forEach((doc) => {
                            const category = doc.data();
                            const categoryId = doc.id;
                            
                            allCategories.push({
                                id: categoryId,
                                ...category
                            });
                            
                            // Adicionar categoria ao submenu do sidebar
                            const categoryItem = document.createElement('li');
                            const categoryLink = document.createElement('a');
                            categoryLink.href = '#';
                            categoryLink.setAttribute('data-category', category.name);
                            categoryLink.innerHTML = `${category.emoji}<span>${category.name}</span>`;
                            
                            categoryLink.addEventListener('click', (e) => {
                                e.preventDefault();
                                currentCategory = category.name;
                                currentSearchQuery = '';
                                searchInput.value = '';
                                filterAndDisplayProducts();
                                closeSidebar();
                            });
                            
                            categoryItem.appendChild(categoryLink);
                            sidebarCategoriesSubmenu.appendChild(categoryItem);
                            
                            // Adicionar opção no select do formulário de produto
                            const option = document.createElement('option');
                            option.value = category.name;
                            option.textContent = `${category.emoji} ${category.name}`;
                            productCategorySelect.appendChild(option);
                        });
                    }
                    
                    // Atualizar estatísticas
                    updateSystemStats();
                })
                .catch((error) => {
                    console.error('Error loading categories: ', error);
                });
        }
        
        // Carregar gerenciamento de categorias
        function loadCategoriesManagement() {
            categoriesGrid.innerHTML = '';
            
            if (allCategories.length === 0) {
                categoriesGrid.innerHTML = `
                    <div style="grid-column: 1 / -1; text-align: center; padding: 2rem;">
                        <i class="fas fa-tags" style="font-size: 3rem; color: #ccc; margin-bottom: 1rem;"></i>
                        <h3>Nenhuma categoria cadastrada</h3>
                        <p>Utilize o botão "Criar Categoria" para adicionar categorias.</p>
                    </div>
                `;
                return;
            }
            
            allCategories.forEach(category => {
                const card = document.createElement('div');
                card.className = 'category-admin-card';
                card.innerHTML = `
                    <div class="emoji">${category.emoji}</div>
                    <div class="name">${category.name}</div>
                    <button class="delete-btn" data-id="${category.id}">
                        <i class="fas fa-trash"></i> Excluir
                    </button>
                `;
                
                categoriesGrid.appendChild(card);
            });
            
            // Adicionar eventos aos botões de deletar
            document.querySelectorAll('.category-admin-card .delete-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const categoryId = e.target.closest('.delete-btn').dataset.id;
                    deleteCategory(categoryId);
                });
            });
        }
        
        // Load products from Firestore
        function loadProducts() {
            loadingSpinner.style.display = 'block';
            productsGrid.innerHTML = '';
            productsGrid.appendChild(loadingSpinner);
            
            db.collection('products').orderBy('createdAt', 'desc').get()
                .then((querySnapshot) => {
                    productsGrid.innerHTML = '';
                    allProducts = [];
                    
                    if (querySnapshot.empty) {
                        productsGrid.innerHTML = `
                            <div style="grid-column: 1 / -1; text-align: center; padding: 2rem;">
                                <i class="fas fa-box" style="font-size: 3rem; color: #ccc; margin-bottom: 1rem;"></i>
                                <h3>Nenhum produto cadastrado</h3>
                                <p>Utilize o painel do administrador para adicionar produtos ao catálogo.</p>
                            </div>
                        `;
                        updateSystemStats();
                        return;
                    }
                    
                    querySnapshot.forEach((doc) => {
                        const product = doc.data();
                        const productId = doc.id;
                        const images = product.imageUrls || [product.imageUrl || 'https://images.unsplash.com/photo-1505740420928-5e560c06d30e?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80'];
                        
                        // Adicionar à lista de todos os produtos
                        allProducts.push({
                            id: productId,
                            ...product,
                            images
                        });
                    });
                    
                    // Atualizar estatísticas
                    updateSystemStats();
                    
                    // Exibir produtos após carregar
                    filterAndDisplayProducts();
                })
                .catch((error) => {
                    console.error('Error loading products: ', error);
                    productsGrid.innerHTML = `
                        <div style="grid-column: 1 / -1; text-align: center; padding: 2rem;">
                            <i class="fas fa-exclamation-triangle" style="font-size: 3rem; color: #cc0000; margin-bottom: 1rem;"></i>
                            <h3>Erro ao carregar produtos</h3>
                            <p>Verifique sua conexão com a internet e tente novamente.</p>
                            ${auth.currentUser ? `
                            <p class="alert alert-warning" style="margin-top: 1rem;">
                                <i class="fas fa-exclamation-circle"></i>
                                <strong>Problema de permissões:</strong> Configure as regras de segurança do Firestore.
                            </p>
                            ` : ''}
                        </div>
                    `;
                });
        }
        
        // Exibir um cartão de produto
        function displayProductCard(productId, product, images) {
            const productCard = document.createElement('div');
            productCard.className = 'product-card';
            
            // Verificar se tem desconto
            let discountBadge = '';
            if (product.oldPrice && product.oldPrice > product.price) {
                const discountPercent = calculateDiscountPercentage(product.oldPrice, product.price);
                discountBadge = `<div class="discount-badge">${discountPercent}% OFF</div>`;
            }
            
            // Determinar texto do status do estoque
            let stockText = '';
            let stockClass = '';
            switch(product.stockStatus) {
                case 'in-stock':
                    stockText = `Em estoque (${product.stock} unidades)`;
                    stockClass = 'in-stock';
                    break;
                case 'low-stock':
                    stockText = `Estoque baixo (${product.stock} unidades)`;
                    stockClass = 'low-stock';
                    break;
                case 'out-of-stock':
                    stockText = 'Fora de estoque';
                    stockClass = 'out-of-stock';
                    break;
                default:
                    if (product.stock > 5) {
                        stockText = `Em estoque (${product.stock} unidades)`;
                        stockClass = 'in-stock';
                    } else if (product.stock > 0) {
                        stockText = `Estoque baixo (${product.stock} unidades)`;
                        stockClass = 'low-stock';
                    } else {
                        stockText = 'Fora de estoque';
                        stockClass = 'out-of-stock';
                    }
            }
            
            // Encontrar emoji da categoria
            let categoryEmoji = '🏷️';
            const categoryData = allCategories.find(cat => cat.name === product.category);
            if (categoryData && categoryData.emoji) {
                categoryEmoji = categoryData.emoji;
            }
            
            // Criar exibição de preço
            let priceDisplay = '';
            if (product.oldPrice && product.oldPrice > product.price) {
                // Preço antigo acima do atual nos cards também
                priceDisplay = `
                    <div style="margin-bottom: 0.5rem; line-height: 1.3;">
                        <span class="product-price">R$ ${product.price.toLocaleString('pt-BR', {minimumFractionDigits: 2})}</span>
                        <span class="product-old-price" style="display: block; font-size: 0.9rem;">De: R$ ${product.oldPrice.toLocaleString('pt-BR', {minimumFractionDigits: 2})}</span>
                    </div>
                `;
            } else {
                priceDisplay = `
                    <div>
                        <span class="product-price">R$ ${product.price.toLocaleString('pt-BR', {minimumFractionDigits: 2})}</span>
                    </div>
                `;
            }
            
            productCard.innerHTML = `
                <div class="product-image">
                    <img src="${images[0]}" alt="${product.title}">
                    ${discountBadge}
                    ${images.length > 1 ? `<div class="image-badge">+${images.length-1}</div>` : ''}
                </div>
                <div class="product-details">
                    <h3 class="product-title">${product.title}</h3>
                    ${priceDisplay}
                    <p class="product-description" style="margin-bottom: 1rem;">${product.description}</p>
                    <!-- Botão VER PRODUTO em VERDE - NOVO -->
                    <button class="view-product-btn" data-id="${productId}">
                        <i class="fas fa-eye"></i> Ver Produto
                    </button>
                    ${auth.currentUser ? `
                    <div class="quick-edit-controls">
                        <button class="quick-edit-btn" data-id="${productId}">
                            <i class="fas fa-edit"></i> Editar
                        </button>
                        <button class="quick-edit-btn" data-id="${productId}" data-action="stock">
                            <i class="fas fa-boxes"></i> Estoque
                        </button>
                        <button class="copy-link-btn" data-id="${productId}">
                            <i class="fas fa-link"></i> Link
                        </button>
                    </div>
                    ` : ''}
                </div>
            `;
            
            productsGrid.appendChild(productCard);
            
            // Evento para o botão "Ver Produto" - NOVO
            const viewProductBtn = productCard.querySelector('.view-product-btn');
            viewProductBtn.addEventListener('click', (e) => {
                e.stopPropagation();
                openProductModal({
                    id: productId,
                    ...product,
                    images
                });
            });
            
            // Tornar o produto clicável para abrir modal (exceto no botão)
            productCard.addEventListener('click', (e) => {
                // Não abrir modal se clicar nos botões de edição rápida ou no botão "Ver Produto"
                if (!e.target.closest('.quick-edit-controls') && 
                    !e.target.closest('.copy-link-btn') && 
                    !e.target.closest('.view-product-btn')) {
                    openProductModal({
                        id: productId,
                        ...product,
                        images
                    });
                }
            });
            
            // Adicionar eventos aos botões de edição rápida (apenas para admin)
            if (auth.currentUser) {
                const editBtns = productCard.querySelectorAll('.quick-edit-btn');
                editBtns.forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        e.stopPropagation();
                        const btnProductId = btn.getAttribute('data-id');
                        const action = btn.getAttribute('data-action');
                        const productData = allProducts.find(p => p.id === btnProductId);
                        
                        if (action === 'stock') {
                            openQuickStockModal(productData);
                        } else {
                            openEditProductModal(productData);
                        }
                    });
                });
                
                // Adicionar evento ao botão de copiar link
                const copyLinkBtn = productCard.querySelector('.copy-link-btn');
                if (copyLinkBtn) {
                    copyLinkBtn.addEventListener('click', (e) => {
                        e.stopPropagation();
                        const productLink = generateProductLink(productId);
                        copyToClipboard(productLink);
                    });
                }
            }
        }
        
        // Atualizar ano atual no footer
        document.getElementById('current-year').textContent = new Date().getFullYear();
        
        // Initial load
        loadProducts();
        loadCategories();
        checkUrlForProduct();
        loadThemeFromFirestore();
        loadThemesInterface();

        // Mostrar instruções de configuração no console
        console.log(`Para resolver o erro de permissões do Firebase, siga estas etapas:
        1. Acesse o console do Firebase: https://console.firebase.google.com/
        2. Selecione seu projeto 'corretora777'
        3. Vá em Firestore Database > Regras
        4. Substitua as regras atuais por:

        rules_version = '2';
        service cloud.firestore {
          match /databases/{database}/documents {
            match /{document=**} {
              allow read: if true;
              allow write: if request.auth != null;
            }
          }
        }
        
        5. Clique em "Publicar"`);
    </script>
</body>
</html>